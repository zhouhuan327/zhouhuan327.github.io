<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>迟到的 2021 个人总结</title>
      <link href="/2022/01/20/2021%E6%80%BB%E7%BB%93/"/>
      <url>/2022/01/20/2021%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<h1 id="2021年终总结"><a href="#2021年终总结" class="headerlink" title="2021年终总结"></a>2021年终总结</h1><h1 id="2021年终总结-1"><a href="#2021年终总结-1" class="headerlink" title="2021年终总结"></a>2021年终总结</h1><p>其实总结的不止今年，而是实习到毕业到现在的感受。平时很少写东西去总结的，但正好借这个机会写了太挺多。</p><h2 id="工作"><a href="#工作" class="headerlink" title="工作"></a>工作</h2><p>工作这块，自己已经不像刚实习的时候那么没有顾忌了。转正之前其实对负责的项目并不是很关系，只想着完成任务，基本是照着UI实现功能就完事了。甚至很多功能虽然是自己写的但自己都不知道怎么用。现在会对业务有自己的思考，会想着怎么提升用户体验，保证代码质量什么的，也算是有一点进步吧。</p><h2 id="技术"><a href="#技术" class="headerlink" title="技术"></a>技术</h2><p>整体来说感觉今年在技术上没有特别显著的进步（相比去年），只是对所用的技术栈更加熟练。像去年实习期间经历了一次项目重构，从vue到react，重构期间自己封装了很多公共轮子，不断的踩坑并独立解决，探索最佳实践的过程中将一个模块重写个三四次等等，收获了不少东西。</p><p>上半年为了做毕设，一个在线聊天室，重新捡起后端知识废了不少劲。好在nest基本等于ts版springboot，简单过了一遍文档就基本会用了，而sql也只需会curd加一点点的联合查询就够能完成基本功能。因为是个前后端同语言的项目，为了考虑把前后端项目放在一起然后共享资源，还学习了lerna，yarn workspace等多包管理工具。上半年的心思基本放在论文和毕业旅行上了，期间还为了更早的请假，一周时间肝出一个大屏，后面回头看的时候看代码感觉惨不忍睹，同时也发现了自己在css上的很多不足。下半年转正之后才开始把更多重心放在业务和项目质量上。  </p><p>不过今年做的业务基本都是属于优化性的，完整的新功能呢不多，简单的任务实现完对技术提升不大，但是复杂的呢像数据分析拖拽配置什么的的又因为太难实现不了，有点迷茫，不知道该怎么提升了。今年的前端轮子也是层出不穷，对于前端社区的要闻我还是挺关心的，期间关注了很多想学的新技术 tailwind,swc,threejs,vite,wasm,rust 等等，但是学习的时候经常是雨露均沾，这个看一点那个看一点写了些demo，可能过几天因为工作繁忙就忘了这个东西了。学习的目标不是很明确，并且大部分技术都没法用到现在项目里，有点不清楚该怎么深入学习，以及未来的学习方向了。</p><p>对于自己的写作和文档输出这一块不是很满意。虽然一直都知道写博客，还有学习时积累笔记的重要性，也定了目标和计划，在平时也会把文章的主题想法记录到todo中，期望是每个月都能输出一篇文章发到掘金上，但实际上今年正经发上去的只有一篇。其他的要么是属于纯笔记性质的非常零散，没法整理成一篇文章。要么是写一半发现自己对这个技术学的还还太浅，根本总结不出什么东西，还有的是写完但是觉得没啥亮点，逻辑也不清晰就不想发了。 实际上就是自己的写作能力太差（从初中开始就怕写作文），导致很难自己把想法很好的用文字归纳出来，通常需要花很多时间来梳理准备资料，组织语言等等，就让我从心底厌恶写作，写这篇个人总结的时候都要修修改改半天。但对于目前的我来说，只能是硬着头皮多写才能提升这一块了。</p><p>总体来说，经过一年的工作学习下来我觉得我已经算一个熟练的切图仔了，应付一般的需求已经没什么问题。但是仅限PC的2B项目，对于移动端/跨端，可视化，前端工程这方面就很缺乏实践。以及对于自己所使用工具框架的原理这方面还知之甚少，还停留在面试八股文级别。</p><blockquote><p>看完雪碧大佬总结的最后一段感觉说的很棒, 摘抄过来修改了下</p></blockquote><p>说起来也是很怀念刚开始写代码时「<em>随便学点 API 都觉得自己更牛逼了呢</em>」的快乐,现在必须得有一些深入的研究，开源项目有很多人start，写的文章有很多赞才会觉得自己有进步。或许这也属于一种边际效用递减吧。</p><p>虽然已经对星辰大海没多少幻想了，但毕竟打工人说躺平终归是躺不平的。</p><p>你看动物之森里都会温柔地提醒你：<strong>为了生活，还是要卷下去啊</strong>。</p><h2 id="期望明年"><a href="#期望明年" class="headerlink" title="期望明年"></a>期望明年</h2><ul><li>找准学习的方向，深入一两个技术</li><li>发掘一个别的爱好，别只打游戏</li><li>搞钱</li><li>还有，没想好</li></ul><h2 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h2><p>本来是一个年度总结，写着写着好像成流水账了，回头看了看排版分段逻辑果然还是乱七八糟的，自己都觉得有点不知所云，真正的总结可能还是只有自己知道吧。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>手写Redux/React-Redux核心API</title>
      <link href="/2021/12/18/redux/"/>
      <url>/2021/12/18/redux/</url>
      
        <content type="html"><![CDATA[<p>Redux/ReactRedux 手写<br> <span id="more"></span></p><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>这篇文章会带大家梳理一下React、React-Redux的原理，以及核心API的最简实现。适合已经使用过redux，但对原理不大了解的读者。</p><h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p>在开始之前先简单介绍一下这两个库,以及他们的区别</p><p><strong>Redux</strong></p><p><code>Redux</code>是一个Javascript状态管理库。他的做的事情非常简单: 使用一个对象去描述应用的状态<code>state</code>,并只能通过<code>action</code>配合<code>reducer</code>去修改<code>state</code>。同时提供了一个订阅服务,在状态被修改时会通知所有订阅者。</p><ul><li><p>state tree</p><p>  存放应用状态的状态树。</p></li><li><p>action<br>  可以将它理解为改变状态的一个指令,通常是一个这样的对象<code>&#123;type: &#39;ADD&#39;,payload: 1&#125;</code>，<code>type</code>字段告诉<code>reducer</code>该怎么去改变<code>store</code>中的状态，<code>payload</code>则是携带的数据。</p></li><li><p>reducer<br> 一个返回新状态的纯函数,它接收一个<code>action</code>,通过判断其中<code>type</code>字段对全局状态进行不同的操作,返回一个全新的状态树。</p></li></ul><p><code>Redux</code>核心部分仅负责状态维护和订阅通知, 是与框架完全无关的。</p><p><strong>React-Redux</strong></p><p><code>React Redux</code> 是 <code>React</code> 的官方 <code>Redux UI</code> 绑定库,帮助用户在组件中拿到<code>Redux</code>中存放的状态以及更新状态的操作。</p><h1 id="实现Redux"><a href="#实现Redux" class="headerlink" title="实现Redux"></a>实现Redux</h1><h2 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h2><p>我们先通过这个<code>DEMO</code>看一下如何使用<code>Redux</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">&#x27;redux&#x27;</span></span><br><span class="line"><span class="keyword">const</span> preloadedState = &#123;</span><br><span class="line">  count: <span class="number">0</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// reducer</span></span><br><span class="line"><span class="keyword">const</span> reducer = <span class="function">(<span class="params">state, action</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.type) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;INCREASE&quot;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123; ...state, <span class="attr">count</span>: state.count + <span class="number">1</span> &#125;;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;DECREASE&quot;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123; ...state, <span class="attr">count</span>: state.count - <span class="number">1</span> &#125;;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;SET_COUNT&quot;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123; ...state, <span class="attr">count</span>: action.payload &#125;;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// action</span></span><br><span class="line"><span class="keyword">const</span> actions = &#123;</span><br><span class="line">  increment: <span class="function">() =&gt;</span> (&#123; <span class="attr">type</span>: <span class="string">&quot;INCREASE&quot;</span> &#125;),</span><br><span class="line">  decrement: <span class="function">() =&gt;</span> (&#123; <span class="attr">type</span>: <span class="string">&quot;DECREASE&quot;</span> &#125;),</span><br><span class="line">  setCount: <span class="function">(<span class="params">count</span>) =&gt;</span> (&#123; <span class="attr">type</span>: <span class="string">&quot;SET_COUNT&quot;</span>, <span class="attr">payload</span>: count &#125;),</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> store = createStore(reducer, preloadedState);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> state = store.getState() <span class="comment">// 获取状态树</span></span><br><span class="line">store.subscribe(<span class="function">() =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&#x27;store变啦&#x27;</span>,store.getState())); <span class="comment">// 订阅状态变化</span></span><br><span class="line">store.dispatch(actions.setCount(<span class="number">233</span>)); <span class="comment">// 触发状态变化</span></span><br><span class="line">store.dispatch(actions.increment()); <span class="comment">// 触发状态变化</span></span><br></pre></td></tr></table></figure><p>可以看到<code>Redux</code>包含了以下方法</p><ul><li><p>createStore<br>接收一个默认状态树和reducer函数并返回一个store,store中包含以下方法</p></li><li><p>store.getState   获取状态</p></li><li><p>store.dispatch   通过派发action去修改状态</p></li><li><p>store.subscribe  订阅状态的变化</p></li></ul><h2 id="createStore"><a href="#createStore" class="headerlink" title="createStore"></a>createStore</h2><h3 id="getState"><a href="#getState" class="headerlink" title="getState"></a>getState</h3><p><code>getState</code>非常简单,我们返回函数中定义的<code>state</code>即可。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createStore</span>(<span class="params">reducer, preloadedState</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> state = preloadedState;  <span class="comment">// 定义初始的状态树</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">const</span> getState = <span class="function">() =&gt;</span> state; <span class="comment">// 返回状态树</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> &#123; getState &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="dispach"><a href="#dispach" class="headerlink" title="dispach"></a>dispach</h3><p>这是一个修改状态的函数，通过前面的介绍我们知道<code>state</code>不应该被直接修改,而是每次需要更新时就通过<code>action</code>和<code>reducer</code>来获得一个新的state tree。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> newState = reducer(oldState,action)</span><br></pre></td></tr></table></figure><p> 所以<code>dispatch</code>需要做的就是接收一个action,通过reducer生成新的<code>state</code> 并替换旧的 <code>state</code></p> <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">createStore</span>(<span class="params">reducer, preloadedState</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> state = preloadedState;  <span class="comment">// 定义初始的状态树</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">const</span> getState = <span class="function">() =&gt;</span> state; <span class="comment">// 返回状态树</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">const</span> dispatch = <span class="function">(<span class="params">action</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 获得新的状态树</span></span><br><span class="line">    state = reducer(state, action);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 这里还需要通知所有订阅者</span></span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> &#123; getState, dispatch &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="subscribe"><a href="#subscribe" class="headerlink" title="subscribe"></a>subscribe</h3><p> 我们已经实现的状态的创建、获取、修改,但都只是对闭包内变量的操作,外界并不能感知到。<code>subscribe</code> 需要提供一个通知外接订阅者状态更新了的这么一个功能。</p><p> 这里我们可以通过实现一个简易的<code>发布订阅模式</code>来达到这个效果。在函数内部再维护一个<code>listeners</code> 数组，里面存放订阅者的回调函数。在每次状态变化（dispatch被调用）时，就执行所有回调。</p> <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">createStore</span>(<span class="params">reducer, preloadedState</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> state = preloadedState;  <span class="comment">// 定义初始的状态树</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">const</span> getState = <span class="function">() =&gt;</span> state; <span class="comment">// 返回状态树</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">const</span> listeners =  [];  </span><br><span class="line">  <span class="comment">// 订阅</span></span><br><span class="line">  <span class="keyword">const</span> subscribe = <span class="function">(<span class="params">fn</span>) =&gt;</span> &#123;</span><br><span class="line">    listeners.push(fn);</span><br><span class="line">    <span class="comment">// 取消订阅</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> index = listeners.find(<span class="function">(<span class="params">item</span>) =&gt;</span> item === fn);</span><br><span class="line">      listeners.splice(index, <span class="number">1</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">const</span> dispatch = <span class="function">(<span class="params">action</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 获得新的状态树</span></span><br><span class="line">    state = reducer(state, action);</span><br><span class="line">    <span class="comment">// 通知所有订阅者</span></span><br><span class="line">    listeners.forEach(<span class="function">(<span class="params">fn</span>) =&gt;</span> fn());</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> &#123; getState , dispatch, subscribe &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> 至此我们已经实现了一个乞丐版本的<code>redux</code>，我们来测试一下</p> <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> preloadedState = &#123;<span class="comment">/** ... */</span>&#125;;</span><br><span class="line"><span class="keyword">const</span> reducer = <span class="function">(<span class="params">state, action</span>) =&gt;</span> &#123;<span class="comment">/** ... */</span>&#125;;</span><br><span class="line"><span class="keyword">const</span> actions = &#123;<span class="comment">/** ... */</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = createStore(reducer, preloadedState);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;初始状态&#x27;</span> , store.getState())</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> unsubscribe = store.subscribe( <span class="comment">// 订阅</span></span><br><span class="line">    () =&gt; <span class="built_in">console</span>.log(<span class="string">&#x27;我知道state变啦&#x27;</span>,store.getState())</span><br><span class="line">); </span><br><span class="line">store.dispatch(actions.setCount(<span class="number">233</span>)); </span><br><span class="line">store.dispatch(actions.increment());</span><br><span class="line"></span><br><span class="line">unsubscribe(); <span class="comment">// 取消订阅</span></span><br><span class="line">store.dispatch(actions.increment());  <span class="comment">// 这次更新不会通知到我</span></span><br></pre></td></tr></table></figure><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1a950b59b634452eb8e63e4470eb450d~tplv-k3u1fbpfcp-watermark.image" class="lazyload" data-srcset="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1a950b59b634452eb8e63e4470eb450d~tplv-k3u1fbpfcp-watermark.image" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image.png"></p><h2 id="combineReducers"><a href="#combineReducers" class="headerlink" title="combineReducers"></a>combineReducers</h2><p>随着应用变得越来越复杂，我们就可以考虑将 <code>reducer 函数</code>拆分成多个单独的函数，每个函数负责独立管理<code>state</code>的一部分。</p><p><code>Redux</code>就有几个扩展api用来增强<code>reducer</code>和<code>dispatch</code>。<code>combineReducers</code>可以将多个<code>reducer</code>合并成一个最终的<code>reducer</code>函数。 <code>applyMiddleware</code>可以让我们自己包装 store 的 <code>dispatch</code>来增强功能，比如实现异步action。</p><p>这里只介绍<code>combineReducers</code>,<br>该方法接收一个对象，通过为传入对象的<code>reducer</code>命名不同的 key 来控制返回 state key 的命名。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 合并后的reducer</span></span><br><span class="line"><span class="keyword">const</span> rootReducer = combineReducers(&#123;<span class="attr">potato</span>: potatoReducer, <span class="attr">tomato</span>: tomatoReducer&#125;)</span><br><span class="line"><span class="comment">// 相应的，state的结构就得是</span></span><br><span class="line"><span class="keyword">const</span> rootState = &#123; <span class="attr">potato</span>: &#123;&#125;, <span class="attr">tomato</span>: &#123;&#125; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = createStore(rootReducer, rootState)</span><br></pre></td></tr></table></figure><p>实现思路就是通过传入对象的<code>key</code>去关联<code>reducer</code>和<code>state中的部分状态</code>，当接收到<code>action</code>时，需要执行所有<code>reducer</code>获得新的状态，然后将这些状态重新组装成一个新的状态树。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">combineReducers</span>(<span class="params">reducers</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> reducerKeys = <span class="built_in">Object</span>.keys(reducers)</span><br><span class="line">    <span class="comment">// 返回合并后的reducer函数</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">combinedReducer</span>(<span class="params">state = &#123;&#125;, action</span>) </span>&#123;</span><br><span class="line">      <span class="comment">// 新的state</span></span><br><span class="line">      <span class="keyword">const</span> nextState = &#123;&#125;</span><br><span class="line">      <span class="comment">// 遍历执行所有的reducers</span></span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; reducerKeys.length; i++) &#123;</span><br><span class="line">        <span class="keyword">const</span> key = reducerKeys[i]   <span class="comment">// 代表state的key</span></span><br><span class="line">        <span class="keyword">const</span> reducer = reducers[key] <span class="comment">// key对应的reducer</span></span><br><span class="line">        <span class="comment">// 当前key对应state的 旧值</span></span><br><span class="line">        <span class="keyword">const</span> prevKeyState = state[key]</span><br><span class="line">        <span class="comment">// 执行reducer,获得当前key对应state的新值</span></span><br><span class="line">        <span class="keyword">const</span> nextKeyState = reducer(prevKeyState, action)</span><br><span class="line">        <span class="comment">// 组装最终的state</span></span><br><span class="line">        nextState[key] = nextKeyState</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> nextState</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h1 id="实现React-Redux"><a href="#实现React-Redux" class="headerlink" title="实现React-Redux"></a>实现React-Redux</h1><h2 id="基本使用-1"><a href="#基本使用-1" class="headerlink" title="基本使用"></a>基本使用</h2><p>和前面一样，我们先看个<code>DEMO</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;./store&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; Provider,connect &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;Provider store=&#123;store&#125;&gt;</span><br><span class="line">      &lt;Header /&gt;</span><br><span class="line">      &lt;Main /&gt;</span><br><span class="line">      &lt;Footer /&gt;</span><br><span class="line">    &lt;/Provider&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 映射state到props</span></span><br><span class="line"><span class="keyword">const</span> mapState = <span class="function">(<span class="params">state</span>) =&gt;</span> (&#123; <span class="attr">count</span>: state.count &#125;);</span><br><span class="line"><span class="comment">// 映射dispatch到props</span></span><br><span class="line"><span class="keyword">const</span> mapDispatch = <span class="function">(<span class="params">dispatch</span>) =&gt;</span> (&#123;</span><br><span class="line">  increment: <span class="function">() =&gt;</span> dispatch(&#123; <span class="attr">type</span>: <span class="string">&quot;increment&quot;</span> &#125;),</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Header = connect(mapState)(<span class="function">(<span class="params">props</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; count &#125; = props;</span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">header</span>&gt;</span> header: &#123;count&#125;<span class="tag">&lt;/<span class="name">header</span>&gt;</span></span>;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">const</span> Main = connect(mapState,mapDispatch)(<span class="function">(<span class="params">props</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; count, increment &#125; = props;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;main&gt;</span><br><span class="line">      Main: count:&#123;count&#125; &lt;button onClick=&#123;increment&#125;&gt;increase &lt;/button&gt;</span><br><span class="line">    &lt;/main&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Footer</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">footer</span>&gt;</span>footer 没用到状态<span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>可以看到 <code>react-redux</code> 提供了一个Provider组件，用于将<code>redux</code>中创建的<code>store</code>透传给所有的子组件。</p><p>以及一个<code>connect</code>函数，它可以让被包裹的组件直接通过<code>props</code>访问<code>store</code>中那些被‘map’的状态和<code>dispatch</code>函数。这里的map可以理解为映射关系。</p><ul><li><code>mapStateToProps</code>函数可以让你控制<code>store</code>中哪些状态会被映射到组件的props中。</li><li><code>mapDispatchToProps</code>让你可以自行封装<code>dispatch</code>函数并映射到<code>props</code>中。</li></ul><p>默认情况下，如果都不传的话组件会拿到整个<code>store</code>和<code>dispatch</code>函数。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">connect(mapStateToProps, mapDispatchToProps)(MyComponent)</span><br></pre></td></tr></table></figure><h2 id="Context"><a href="#Context" class="headerlink" title="Context"></a>Context</h2><p>使用<code>React</code>的<code>createContext</code>方法直接创建一个context即可</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">const</span> ReduxContext = React.createContext(<span class="literal">null</span>)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> ReduxContext</span><br></pre></td></tr></table></figure><h2 id="Provider"><a href="#Provider" class="headerlink" title="Provider"></a>Provider</h2><p><code>Provider</code> 接收<code>store</code> 并通过 <code>ReduxContext</code> 传给所有子组件</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> ReduxContext <span class="keyword">from</span> <span class="string">&quot;./Context&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> Provider = <span class="function">(<span class="params">props: any</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; store, children, ...rest &#125; = props;</span><br><span class="line">  <span class="comment">// 把store透传给所有子组件</span></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;ReduxContext.Provider value=&#123;store&#125; &#123;...rest&#125;&gt;</span><br><span class="line">      &#123;children&#125;</span><br><span class="line">    &lt;/ReduxContext.Provider&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Provider;</span><br></pre></td></tr></table></figure><h2 id="connect"><a href="#connect" class="headerlink" title="connect"></a>connect</h2><p>先通过<code>connect</code>的调用方式去推断一下<code>connect</code>函数的结构。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">connect(mapStateToProps, mapDispatchToProps)(MyComponent)</span><br></pre></td></tr></table></figure><p>首先它接收<code>mapStateToProps</code>,<code>mapDispatchToProps</code> 这两个函数，并且又返回了一个函数,该函数接收一个组件，并且能让组件中的<code>props</code>获得参数。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">connect</span>(<span class="params">mapStateToProps, mapDispatchToProps</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">wrapWithConnect</span>(<span class="params">component</span>) </span>&#123;</span><br><span class="line">   <span class="comment">// 这里需要向组件的props中注入参数</span></span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>那么怎么才能在<code>wrapWithConnect</code>函数中拿到<code>store</code>，并传给组件的<code>props</code>呢？ <code>store</code>是通过<code>context</code>透传的，而只有在组件中才能消费<code>context</code>,所以很明显需要通过高阶组件（HOC）来实现这个功能。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">connect</span>(<span class="params">mapStateToProps?: any, mapDispatchToProps?: any</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">wrapWithConnect</span>(<span class="params">component</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 包裹组件，主要为了获取组件上下文</span></span><br><span class="line">    <span class="keyword">const</span> HOC = <span class="function">(<span class="params">props</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> &#123; dispatch, getState, subscribe &#125; = useContext(AppContext);</span><br><span class="line">      <span class="keyword">const</span> state = getState();</span><br><span class="line">      <span class="function"><span class="keyword">function</span> <span class="title">childPropsSelector</span>(<span class="params">state</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 注入到props中的状态</span></span><br><span class="line">        <span class="comment">// 可能是整个store, 也可能是被mapState 返回的几个特定状态</span></span><br><span class="line">        <span class="keyword">const</span> stateProps = mapStateToProps ? mapStateToProps(state) : state;</span><br><span class="line">        <span class="comment">// 注入到props中改变状态的函数</span></span><br><span class="line">        <span class="comment">// 可以是原本的dispatch,也可以是mapDispatch 返回的特定更新状态的函数</span></span><br><span class="line">        <span class="keyword">const</span> dispatchProps = mapDispatchToProps</span><br><span class="line">          ? mapDispatchToProps(dispatch)</span><br><span class="line">          : dispatch;</span><br><span class="line">        <span class="keyword">return</span> &#123; ...stateProps, ...dispatchProps, ...props &#125;;</span><br><span class="line">      &#125;</span><br><span class="line">       <span class="comment">// 获得最终子组件的的props</span></span><br><span class="line">      <span class="keyword">const</span> actualChildProps = childPropsSelector(state);</span><br><span class="line">      <span class="keyword">return</span> React.createElement(component, actualChildProps, props.children);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> HOC;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>通过一层高阶组件的包裹，我们可以从context中拿到<code>store</code>的信息，并经过一顿处理传给被包裹的组件。</p><p>接下来我们需要实现组件的更新，在react中更新组件的方式是通过<code>setState</code>,每次传入一个新的值就能触发更新。</p><p>通过<code>store</code>提供的的<code>subscribe</code>方法，我们可以知道状态在什么时候被<code>dispatch</code>，被改变了。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 强制更新组件</span></span><br><span class="line"><span class="keyword">const</span> [, forceUpdate] = useState(&#123;&#125;);</span><br><span class="line">useEffect(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> unsubscribe = subscribe(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    forceUpdate(&#123;&#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> unsubscribe;</span><br><span class="line">&#125;, []);</span><br></pre></td></tr></table></figure><p>这里还需要做一个小优化。现在的代码即使<code>dispatch</code>后的状态没有改变，组件中也会收到通知并触发组件的<code>render</code>。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 记录上一次渲染时的state</span></span><br><span class="line"><span class="keyword">const</span> preStateRef = useRef(&#123;&#125;);</span><br><span class="line">preStateRef.current = state</span><br><span class="line"></span><br><span class="line"><span class="comment">// 订阅store</span></span><br><span class="line">useEffect(<span class="function">() =&gt;</span> &#123;</span><br><span class="line"><span class="keyword">const</span> unsubscribe = subscribe(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 对比新的state和旧的state</span></span><br><span class="line">  <span class="keyword">const</span> state = getState();</span><br><span class="line">  <span class="keyword">if</span> (!isShadowEqual(preStateRef.current, state)) &#123;</span><br><span class="line">    forceUpdate(&#123;&#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">return</span> unsubscribe;</span><br><span class="line">&#125;, []);</span><br></pre></td></tr></table></figure><p>通过一个ref去记录旧的state,并在每次<code>render</code>之前对新旧<code>state</code>做一次浅层次的对比，就可以减少不必要的重渲染。当然真正的场景下不会只有这么简单的判断，具体可以查看源码<a href="https://github.com/reduxjs/react-redux/blob/7.x/src/components/connectAdvanced.js#L75">react-redux 源码</a></p><p>最终的实现代码如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; useContext, useEffect, useRef, useState &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> ReduxContext <span class="keyword">from</span> <span class="string">&quot;./Context&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">connect</span>(<span class="params">mapStateToProps, mapDispatchToProps</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">wrapWithConnect</span>(<span class="params">component</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> HOC = <span class="function">(<span class="params">props</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> &#123; dispatch, getState, subscribe &#125; = useContext(ReduxContext);</span><br><span class="line">      <span class="keyword">const</span> state = getState();</span><br><span class="line">      <span class="keyword">const</span> [, forceUpdate] = useState(&#123;&#125;);</span><br><span class="line">      <span class="function"><span class="keyword">function</span> <span class="title">childPropsSelector</span>(<span class="params">state</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">const</span> stateProps = mapStateToProps ? mapStateToProps(state) : state;</span><br><span class="line">        <span class="keyword">const</span> dispatchProps = mapDispatchToProps</span><br><span class="line">          ? mapDispatchToProps(dispatch)</span><br><span class="line">          : dispatch;</span><br><span class="line">        <span class="keyword">return</span> &#123; ...stateProps, ...dispatchProps, ...props &#125;;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 最终子组件的props</span></span><br><span class="line">      <span class="keyword">const</span> actualChildProps = childPropsSelector(state);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 记录上一次渲染时的state</span></span><br><span class="line">      <span class="keyword">const</span> preStateRef = useRef(&#123;&#125;);</span><br><span class="line">      preStateRef.current = state;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 订阅store</span></span><br><span class="line">      useEffect(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> unsubscribe = subscribe(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">          <span class="comment">// 对比新的state和旧的state</span></span><br><span class="line">          <span class="keyword">const</span> state = getState();</span><br><span class="line">          <span class="keyword">if</span> (!isShadowEqual(preStateRef.current, state)) &#123;</span><br><span class="line">            forceUpdate(&#123;&#125;);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span> unsubscribe;</span><br><span class="line">      &#125;, []);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> React.createElement(component, actualChildProps, props.children);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> HOC;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isShadowEqual</span>(<span class="params">origin: any, next: any</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">Object</span>.is(origin, next)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (</span><br><span class="line">    origin &amp;&amp;</span><br><span class="line">    <span class="keyword">typeof</span> origin === <span class="string">&quot;object&quot;</span> &amp;&amp;</span><br><span class="line">    next &amp;&amp;</span><br><span class="line">    <span class="keyword">typeof</span> next === <span class="string">&quot;object&quot;</span></span><br><span class="line">  ) &#123;</span><br><span class="line">    <span class="keyword">if</span> (</span><br><span class="line">      [...Object.keys(origin), ...Object.keys(next)].every(</span><br><span class="line">        (k) =&gt;</span><br><span class="line">          origin[k] === next[k] &amp;&amp;</span><br><span class="line">          origin.hasOwnProperty(k) &amp;&amp;</span><br><span class="line">          next.hasOwnProperty(k)</span><br><span class="line">      )</span><br><span class="line">    ) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> connect;</span><br></pre></td></tr></table></figure><h2 id="Hooks-API"><a href="#Hooks-API" class="headerlink" title="Hooks API"></a>Hooks API</h2><p>除了使用<code>connect</code>，<code>React-Redux</code>还支持使用hook的方式去访问<code>store</code></p><ul><li><code>useStore</code>  拿到store的对象</li><li><code>useSelector</code> 使用选择器函数从<code>state</code>中提取数据</li><li><code>useDipatch</code> 拿到dispatch函数<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useSelector, useStore, useDispatch &#125; <span class="keyword">from</span> <span class="string">&quot;react-redux&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> CounterComponent = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> store = useStore()</span><br><span class="line">  <span class="keyword">const</span> count = useSelector(<span class="function">(<span class="params">state</span>) =&gt;</span> state.counter);</span><br><span class="line">  <span class="keyword">const</span> dispatch = useDispatch()</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">          &#123;count&#125;</span><br><span class="line">          &lt;button onClick=&#123;<span class="function">() =&gt;</span> dispatch(&#123;<span class="attr">type</span>: <span class="string">&#x27;inc&#x27;</span>&#125;)&#125;&gt;increase&lt;/button&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li></ul><p>访问<code>store</code>需要拿到<code>context</code>,而这里的调用都不需要我们自己传入<code>context</code>，所以需要事先拿到到这个<code>context</code>对象。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; useEffect, useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> context <span class="keyword">from</span> <span class="string">&#x27;./Context&#x27;</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createSelectorHook</span>(<span class="params">context</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> useSelector = <span class="function">(<span class="params">selector</span>) =&gt;</span> &#123;&#125;</span><br><span class="line">  <span class="keyword">return</span> useSelector</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> createSelectorHook(context);</span><br></pre></td></tr></table></figure><p>拿到<code>context</code>之后，就可以通过<code>React.useContext</code>访问到<code>store</code>了,接下来处理方式就和<code>connect</code>类似</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; useEffect, useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> context <span class="keyword">from</span> <span class="string">&#x27;./Context&#x27;</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createSelectorHook</span>(<span class="params">context</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> useReduxContext = <span class="function">() =&gt;</span> React.useContext(context)</span><br><span class="line">  <span class="keyword">const</span> useSelector = <span class="function">(<span class="params">selector</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; getState,subscribe &#125; = useReduxContext()</span><br><span class="line">    <span class="keyword">const</span> state = getState()</span><br><span class="line">    <span class="keyword">const</span> selectedState = selector(state);</span><br><span class="line">     <span class="comment">// 强制更新组件</span></span><br><span class="line">     <span class="keyword">const</span> [, forceUpdate] = useState(&#123;&#125;);</span><br><span class="line">      <span class="comment">// 订阅store</span></span><br><span class="line">      useEffect(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> unsubscribe = subscribe(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">          <span class="comment">// 这里省略的state的浅层对比</span></span><br><span class="line">          forceUpdate(&#123;&#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span> unsubscribe;</span><br><span class="line">      &#125;, []);</span><br><span class="line">    <span class="keyword">return</span> selectedState;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> useSelector</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> createSelectorHook(context);</span><br></pre></td></tr></table></figure><p>其他两个API也是类似的思路，这里不再赘述。hooks的方式更适在函数组件中使用，不需要事前给组件包一层，更加的方便。而<code>connect</code>更适合类组件，也可以通过<code>@connect 装饰器</code>简化这一层包裹的过程。</p><h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>本文通过一些的代码示例，手写实现了<code>React</code>和<code>React-Redux</code>的一些常用函数，实现参考了源码但是简化了很多优化和错误判断的步骤，重点在于梳理出实现功能的大致思路。<br>如有描述不正确的地方，欢迎大家指正！</p>]]></content>
      
      
      
        <tags>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>typescript in react hooks</title>
      <link href="/2021/03/30/typescript-in-react-hooks/"/>
      <url>/2021/03/30/typescript-in-react-hooks/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>React Hooks 学习笔记</title>
      <link href="/2020/07/26/ReactHooks-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
      <url>/2020/07/26/ReactHooks-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="React-Hooks"><a href="#React-Hooks" class="headerlink" title="React Hooks"></a>React Hooks</h1><h2 id="动机"><a href="#动机" class="headerlink" title="动机"></a>动机</h2><ul><li>能优化类组件的一些问题<ul><li>不同组件之间的状态逻辑难以复用</li><li>复杂组件变得难以理解</li><li>class带来的一些问题，比如this指向</li></ul></li></ul><h2 id="使用Hook的注意事项"><a href="#使用Hook的注意事项" class="headerlink" title="使用Hook的注意事项"></a>使用Hook的注意事项</h2><ul><li>只在函数的顶层调用Hook函数，不要在<strong>循环，条件判断，嵌套函数</strong>中使用</li><li>不要在普通<code>javascript</code>函数中调用Hook，而是在React组件中</li><li>不要在 <code>useMemo</code>、<code>useReducer</code> 或 <code>useEffect</code> 的参数函数中调用。</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> React </tag>
            
            <tag> 笔记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>前端面试题</title>
      <link href="/2020/07/26/%E9%9D%A2%E8%AF%95/"/>
      <url>/2020/07/26/%E9%9D%A2%E8%AF%95/</url>
      
        <content type="html"><![CDATA[<blockquote><p>之前准备面试的时候记录的一些常见面试题，后续继续补充</p></blockquote><span id="more"></span><h2 id="HTML"><a href="#HTML" class="headerlink" title="HTML"></a>HTML</h2><h3 id="如何理解-HTML-语义化"><a href="#如何理解-HTML-语义化" class="headerlink" title="如何理解 HTML 语义化"></a>如何理解 HTML 语义化</h3><p><strong><em>正确的标签做正确的事情</em></strong>，比如标题用 H1-H5 标签，段落用 p 标签，主要内容用 main 标签。</p><p>html 语义化可以让页面的结构更清晰，增加可读性。</p><p>有利于 SEO（搜索引擎优化）</p><p><strong><em>相关知识</em></strong></p><p>语义化的标签包括：body,header,nav,aside,articel,section,footer</p><p>header: 代表页眉，通常包含 h1-h6 元素或者 hgroup</p><p>article: 代表文档，页面中的一个内容。article 内部可以嵌套 section，代表相关内容</p><img src="https://image-static.segmentfault.com/194/538/1945387418-577912749fc9c_articlex" class="lazyload" data-srcset="https://image-static.segmentfault.com/194/538/1945387418-577912749fc9c_articlex" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="     ><h3 id="用过哪些-HTML5-标签"><a href="#用过哪些-HTML5-标签" class="headerlink" title="用过哪些 HTML5 标签"></a>用过哪些 HTML5 标签</h3><p>内容相关的 header，main，footer，article（定义独立于文档其他部分的内容），section（表示文档的一个组成部分）</p><p>文字相关的 data，time，mark</p><p>功能相关的 video，<strong>canvas</strong>，audio，<strong>svg</strong></p><p>后续问题：canvas 是如何绘制的等等等。</p><p><strong>canvas</strong>是一个可以用 js 来绘制图形的 HTML 元素。</p><p><strong>使用方法</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> canvas = <span class="built_in">document</span>.getElementById(<span class="string">&quot;canvas&quot;</span>); <span class="comment">//获取这个元素的引用</span></span><br><span class="line"><span class="keyword">const</span> ctx = canvas.getContext(<span class="string">&quot;2d&quot;</span>); <span class="comment">//调用getContext()方法获取元素的上下文</span></span><br><span class="line"></span><br><span class="line">ctx.fillStyle = <span class="string">&quot;green&quot;</span>;</span><br><span class="line">ctx.fillRect(<span class="number">10</span>, <span class="number">10</span>, <span class="number">150</span>, <span class="number">100</span>);</span><br></pre></td></tr></table></figure><p>video 用于在 HTML 或者 XHTML 文档中嵌入媒体播放器</p><p>controls 允许用户控制视频的播放</p><p>poster 设置封面</p><p><strong>事件</strong>：click,pause,play,timeupdate</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Simple video example --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">video</span> <span class="attr">controls</span> <span class="attr">src</span>=<span class="string">&quot;videofile.ogg&quot;</span> <span class="attr">autoplay</span> <span class="attr">poster</span>=<span class="string">&quot;posterimage.jpg&quot;</span>&gt;</span></span><br><span class="line">  抱歉，您的浏览器不支持内嵌视频，不过不用担心，你可以 <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;videofile.ogg&quot;</span>&gt;</span>下载<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  并用你喜欢的播放器观看!</span><br><span class="line"><span class="tag">&lt;/<span class="name">video</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- Video with subtitles --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">video</span> <span class="attr">src</span>=<span class="string">&quot;foo.ogg&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">track</span> <span class="attr">kind</span>=<span class="string">&quot;subtitles&quot;</span> <span class="attr">src</span>=<span class="string">&quot;foo.en.vtt&quot;</span> <span class="attr">srclang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">label</span>=<span class="string">&quot;English&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">track</span> <span class="attr">kind</span>=<span class="string">&quot;subtitles&quot;</span> <span class="attr">src</span>=<span class="string">&quot;foo.sv.vtt&quot;</span> <span class="attr">srclang</span>=<span class="string">&quot;sv&quot;</span> <span class="attr">label</span>=<span class="string">&quot;Svenska&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 字幕 --!&gt;</span></span><br><span class="line"><span class="comment">&lt;/video&gt;</span></span><br></pre></td></tr></table></figure><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/Guide/HTML/HTML5/HTML5_element_list">HTML5 标签列表</a></p><h3 id="严格模式与混杂模式"><a href="#严格模式与混杂模式" class="headerlink" title="严格模式与混杂模式"></a>严格模式与混杂模式</h3><blockquote><p><strong>Doctype 作用是什么</strong></p></blockquote><p>!DOCTYPE 声明叫做文件类型定义（DTD），声明的作用为了告诉浏览器该用什么文档类型的规范来解析这个文档</p><p><strong>严格模式：</strong>又称标准模式，是指浏览器按照 W3C 标准解析代码。</p><p><strong>混杂模式：</strong>又称怪异模式或兼容模式，是一种向后兼容的解析方法</p><p><strong>HTML5 没有严格和混杂之分</strong></p><h3 id="meta-viewport"><a href="#meta-viewport" class="headerlink" title="meta viewport"></a>meta viewport</h3><p>meta viewport 是用来做移动端适配的,name 为 viewport 表示供移动设备使用. content 定义了 viewport 的属性.</p><p><strong>viewport</strong>就是设备的屏幕上能用来显示网页的那一块区域</p><table><thead><tr><th>属性名</th><th>说明</th></tr></thead><tbody><tr><td>width</td><td>设置 layout viewport 的宽度，为一个正整数，或字符串 width-device</td></tr><tr><td>initial-scale</td><td>设置页面的初始缩放值，为一个数字，可以带小数</td></tr><tr><td>minimum-scale</td><td>允许用户的最小缩放值，为一个数字，可以带小数</td></tr><tr><td>maximum-scale</td><td>允许用户的最大缩放值，为一个数字，可以带小数</td></tr><tr><td>user-scalable</td><td>是否允许用户进行缩放，值为”no”或”yes”, no 代表不允许，yes 代表允许</td></tr></tbody></table><p>常用写法</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;meta</span><br><span class="line">  name=&quot;viewport&quot;</span><br><span class="line">  content=&quot;width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0&quot;</span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure><p><a href="https://segmentfault.com/a/1190000020218602">https://segmentfault.com/a/1190000020218602</a></p><h2 id="CSS"><a href="#CSS" class="headerlink" title="CSS"></a>CSS</h2><h3 id="什么是响应式设计？"><a href="#什么是响应式设计？" class="headerlink" title="什么是响应式设计？"></a>什么是响应式设计？</h3><p>响应式网站设计是一个网站能够兼容多个终端，而不是为每一个终端做一个特定的版本。</p><p>基本原理是通过媒体查询<code>（@media）</code>查询检测不同的设备屏幕尺寸做处理。</p><p>关于兼容： 页面头部必须有 mate 声明的<code>viewport</code>。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta</span><br><span class="line">  name=<span class="string">&quot;’viewport’&quot;</span></span><br><span class="line">  content=<span class="string">&quot;”width=device-width,&quot;</span></span><br><span class="line">  initial-scale=<span class="string">&quot;1.&quot;</span></span><br><span class="line">  maximum-scale=<span class="string">&quot;1,user-scalable=no”&quot;</span></span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure><h3 id="CSS3-有哪些新特性？"><a href="#CSS3-有哪些新特性？" class="headerlink" title="CSS3 有哪些新特性？"></a>CSS3 有哪些新特性？</h3><p>关于<code>CSS</code>新增的特性，有以下：</p><ul><li>选择器;</li><li>圆角<code>（border-raduis）</code>;</li><li>阴影<code>（shadow）</code>和反射<code>（reflect）</code>;</li><li>文字特效<code>（text-shadow）</code>;</li><li>文字渲染<code>（text-decoration</code>）;</li><li>线性渐变<code>（gradient）</code>;</li><li>旋转<code>（rotate</code>）/缩放<code>（scale）</code>/倾斜<code>（skew）</code>/移动<code>（translate）</code>;</li><li>媒体查询<code>（@media）</code>;</li><li><code>RGBA</code>和透明度 ;</li><li><code>@font-face</code>属性;</li><li>多背景图 ;</li><li>盒子大小;</li><li>语音;</li></ul><h3 id="两种盒模型"><a href="#两种盒模型" class="headerlink" title="两种盒模型"></a>两种盒模型</h3><p>早期 IE 的 border-box（怪异盒模型），W3C 的 content-box（标准盒模型）</p><ul><li><p>content-box</p><p>width = 内容的宽度</p><p>height = 内容的高度</p></li><li><p>border-box</p><p>width = border+padding+内容的宽度</p><p>height = border+padding+内容的高度</p></li></ul><p>使用<strong>box-sizing</strong>来设置两种盒模型</p><p><strong>后续问题</strong>：哪种更好，为什么？</p><p>border-box 更好，因为 border-box 计算了元素的边框，使得不会和其他元素重叠，写起来更方便</p><p>【关键词】那一种写起来更方便</p><h3 id="BFC-是什么"><a href="#BFC-是什么" class="headerlink" title="BFC 是什么"></a>BFC 是什么</h3><blockquote><p><strong>块格式化上下文</strong>（Block Formatting Context，BFC）,是布局过程中生成块级盒子的区域，也是浮动元素与其他元素的交互限定区域</p></blockquote><p><strong>BFC 是规定内部块级元素摆放规则的一个独立环境</strong></p><ol><li>块级盒子按照垂直方向，一个接一个的放置</li><li>块级盒子的垂直方向边距由上下 margin 决定，属于同一个 BFC 的两个相邻 Box 的上下 margin 会发生重叠</li><li>BFC 就是页面上的一个隔离的独立容器，容器里面的子元素不会影响到外面的元素</li><li>计算 BFC 的高度时，浮动元素也参与计算</li></ol><p><strong>如何创建 BFC</strong></p><ol><li>根元素（html 标签）或包含根元素的元素</li><li><strong>浮动</strong>元素（元素的 float 不是 none）</li><li><strong>绝对定位</strong>元素（元素的 position 为 absolute 或 fixed）</li><li>overflow 值不为 visible 的块元素</li><li>display 的值为 inline-block、table-cell、table-caption</li><li>display 为<strong>flow-root</strong>(CSS3 新增)</li></ol><p><strong>应用场景</strong></p><p>举几个含有 BFC 的例子</p><ol><li><p>解决高度坍塌</p><p>浮动的元素会导致父元素高度坍塌，在父元素上加上 overflow:hidden，触发 BFC 重新计算元素尺寸。</p></li><li><p>解决 margin 重叠(同一个 BFC 中，相邻块级盒的竖直 margin 会合并)</p><p>在其中一个元素外面包一层容器，并触发容器生成 BFC。那么两个重叠的元素不属于同一个 BFC，就不会发生 margin 重叠</p></li><li><p>float+div 左右自适应布局</p><p>侧边栏 float:left 右边 overflow：auto ，都触发了 bfc</p></li></ol><h3 id="清除浮动"><a href="#清除浮动" class="headerlink" title="清除浮动"></a>清除浮动</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.clearfix</span> &#123;</span><br><span class="line">  zoom: <span class="number">1</span>； //ie兼容</span><br><span class="line">;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.clearfix</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;&quot;</span>;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">clear</span>: both;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>或者创建 bfc</p><h3 id="CSS-选择器"><a href="#CSS-选择器" class="headerlink" title="CSS 选择器"></a>CSS 选择器</h3><p>有哪些选择器？</p><ul><li>ID 选择器（#myId）</li><li>类选择器（.myClass）</li><li>标签选择器（p,div）</li><li>相邻选择器（div+p）</li><li>子选择器（div&gt;p）</li><li>后代选择器（div p）</li><li>属性选择器（button[disabled=”true”]）</li><li>伪类选择器（a:hover）</li><li>伪元素选择器(div::before,div::after)</li></ul><p>!important &gt; style(内联) &gt; ID &gt; 类选择器/属性选择器/伪类 &gt; 标签选择器/伪元素</p><p>同权重情况下： 内联样式表（标签内部）&gt; 嵌入样式表（当前文件中）&gt; 外部样式表（外部文件中）</p><h3 id="样式的继承"><a href="#样式的继承" class="headerlink" title="样式的继承"></a>样式的继承</h3><p>可继承的样式：font-size,font-family,font-weight，color，visibility，</p><p>不可继承的样式：display,border,padding,margin,width,height 等等</p><h3 id="flex"><a href="#flex" class="headerlink" title="flex"></a>flex</h3><h3 id="如何实现垂直居中"><a href="#如何实现垂直居中" class="headerlink" title="如何实现垂直居中"></a>如何实现垂直居中</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;parent&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;child&quot;</span>&gt;</span>一串文字<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.parent</span> &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid red;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.child</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>元素宽高固定</p><p>绝对定位+负 margin</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.parent</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.child</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">margin-left</span>: -<span class="number">50px</span>; //自身宽度的一半</span><br><span class="line">  <span class="attribute">margin-top</span>: -<span class="number">50px</span>; //自身高度的一半</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>绝对定位+margin auto</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.parent</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.child</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">margin</span>: auto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>元素不定宽高</p><p>绝对定位+transform</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.parent</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.child</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">50%</span>, -<span class="number">50%</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>lineheight</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.parent</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">300px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.child</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  <span class="attribute">vertical-align</span>: middle;</span><br><span class="line">  <span class="attribute">line-height</span>: initial;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>table-cell</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.parent</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: table-cell;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">vertical-align</span>: middle;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.child</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>flex</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.parent</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="如何实现两栏布局"><a href="#如何实现两栏布局" class="headerlink" title="如何实现两栏布局"></a>如何实现两栏布局</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">section</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">aside</span>&gt;</span>aside<span class="tag">&lt;/<span class="name">aside</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">main</span>&gt;</span>main<span class="tag">&lt;/<span class="name">main</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">section</span>&gt;</span></span><br></pre></td></tr></table></figure><ol><li><p>flex 布局</p><p>父容器设置<code>display:flex</code>，定宽的一栏设置 flex-basic 或者 width，自适应的那一栏设置<code>flex:1</code> 或者<code>flex-grow:1</code></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">section</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">aside</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">main</span> &#123;</span><br><span class="line">  <span class="attribute">flex-grow</span>: <span class="number">1</span>;</span><br><span class="line">  <span class="comment">/* 控制展示的顺序*/</span></span><br><span class="line">  <span class="attribute">order</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>grid 布局</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">section</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: gird;</span><br><span class="line">  <span class="comment">/* 格子是两列，第一列宽度200px ,第二列撑满剩余空间 */</span></span><br><span class="line">  grid-template-<span class="attribute">columns</span>: <span class="number">200px</span> <span class="number">1</span>fr;</span><br><span class="line">  grid-template-rows: auto;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">aside</span> &#123;</span><br><span class="line">  <span class="comment">/* 放在第一和第二根线之间*/</span></span><br><span class="line">  grid-column: <span class="number">1</span>/<span class="number">2</span>;</span><br><span class="line">  grid-row: <span class="number">1</span>/<span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">main</span> &#123;</span><br><span class="line">  grid-column: <span class="number">2</span>/<span class="number">3</span>;</span><br><span class="line">  grid-row: <span class="number">1</span>/<span class="number">2</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>传统浮动布局</p><p>a. 定宽的一栏设置左/右浮动，自适应的一栏设置左/右 margin 预留空间。同时为了防止父元素高度坍塌，还要清浮动。</p><p>b. 圣杯布局/双飞翼布局，主要利用的浮动和负 margin 的特性</p></li></ol><h3 id="什么是回流（重排）和重绘以及其区别？"><a href="#什么是回流（重排）和重绘以及其区别？" class="headerlink" title="什么是回流（重排）和重绘以及其区别？"></a>什么是回流（重排）和重绘以及其区别？</h3><p>回流（重排）<code>reflow</code>:当<code>render tree</code>中的一部分（或全部）因为元素的规模尺寸，布局，隐藏等改变时而需要重新构建；</p><p>重绘<code>repaint</code>:当<code>render tree</code>中的一些元素需要更新属性，而这些属性只影响元素的外观，风格，而不会影响布局时，称其为<strong>重绘</strong>，例如颜色改变等。</p><h2 id="JS"><a href="#JS" class="headerlink" title="JS"></a>JS</h2><h3 id="跨域"><a href="#跨域" class="headerlink" title="*跨域"></a>*跨域</h3><p>出于安全原因，浏览器会限制从脚本内发起的<strong>跨域</strong>HTTP 请求</p><p>只要<strong>协议、域名、端口</strong>有任何一个不同，都被当作是不同的域</p><p><strong>JSONP 跨域</strong></p><p>通过 script 标签引入的 js 是不受同源策略的限制的（jsonp 只能实现 get 请求）</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//原生的实现方式</span></span><br><span class="line"><span class="keyword">let</span> script = <span class="built_in">document</span>.createElement(<span class="string">&quot;script&quot;</span>);</span><br><span class="line"></span><br><span class="line">script.src = <span class="string">&quot;http://www.xxx.cn/login?username=zh&amp;callback=callback&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.body.appendChild(script);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">callback</span>(<span class="params">res</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(res);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>CORS</strong></p><p>CORS 是一个 W3C 标准，全称是”<strong>跨域资源共享</strong>“（Cross-origin resource sharing）。</p><p>浏览器将 CORS 请求分成两类：<strong>简单请求</strong>（simple request）和<strong>非简单请求</strong>（not-so-simple request）。</p><p><strong>简单请求：</strong></p><ul><li><p>请求方法是以下三种方法之一：HEAD,GET,POST</p></li><li><p>http 头信息不超出一下字段：Accept、Accept-Language 、 Content-Language、 Last-Event-ID、 Content-Type(限于三个值：application/x-www-form-urlencoded、multipart/form-data、text/plain)</p></li></ul><p>对于简单请求，浏览器直接发出 CORS 请求。具体来说，就是在头信息之中，增加一个 Origin 字段。Origin 字段用来说明，本次请求来自哪个源（协议 + 域名 + 端口）。服务器根据这个值，决定是否同意这次请求。</p><p>如果<code>Origin</code>指定的源不在许可范围内服务器会返回一个正常的 HTTP 回应。浏览器发现，这个回应的头信息没有包含<code>Access-Control-Allow-Origin</code>字段。</p><p>如果<code>Origin</code>指定的域名在许可范围内，服务器返回的响应，会多出几个头信息字段。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Access-Control-Allow-Origin: <span class="string">&#x27;origin中指定的源（协议 + 域名 + 端口）&#x27;</span></span><br><span class="line">Access-Control-Allow-Credentials: <span class="literal">true</span></span><br><span class="line">Access-Control-Expose-Headers: FooBar</span><br><span class="line">Content-Type: text/html; charset=utf-<span class="number">8</span></span><br></pre></td></tr></table></figure><p><strong>非简单请求</strong>是那种对服务器有特殊要求的请求，比如请求方法是<strong>PUT 或 DELETE</strong>，或者 Content-Type 字段的类型是<strong>application/json</strong></p><p>非简单请求会在正式通信之前，增加一次 HTTP 查询请求，称为”预检”请求（preflight）。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">OPTIONS /cors HTTP/<span class="number">1.1</span></span><br><span class="line">Origin: http:<span class="comment">//api.bob.com</span></span><br><span class="line">Access-Control-Request-Method: PUT</span><br><span class="line">Access-Control-Request-Headers: X-Custom-Header</span><br><span class="line">Host: api.alice.com</span><br><span class="line">Accept-Language: en-US</span><br><span class="line">Connection: keep-alive</span><br><span class="line">User-Agent: Mozilla/<span class="number">5.0</span>...</span><br></pre></td></tr></table></figure><p>服务器收到”预检”请求以后，检查了<code>Origin</code>、<code>Access-Control-Request-Method</code>和<code>Access-Control-Request-Headers</code>字段以后，确认允许跨源请求，就可以做出回应。</p><p>如果服务器否定了”预检”请求，会返回一个正常的 HTTP 回应，但是没有任何 CORS 相关的头信息字段。这时，浏览器就会认定，服务器不同意预检请求</p><p><strong>通过反向代理跨域</strong></p><p>跨域是浏览器禁止的，服务端并不禁止跨域</p><p>所以浏览器可以发给自己的服务端然后，由自己的服务端再转发给要跨域的服务端，做一层代理<br><code>vue-cli</code>的<code>proxyTable</code>用的是<code>http-proxy-middleware</code>中间件<br><code>create-react-app</code>用的是<code>webpack-dev-server</code>内部也是用的<code>http-proxy-middleware</code><br><code>http-proxy-middleware</code>内部用的<code>http-proxy</code></p><p><strong>nginx</strong></p><p>只需要在 Nginx 的配置文件中配置以下参数：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">location / &#123;</span><br><span class="line">    add_header Access-Control-Allow-Origin *;</span><br><span class="line">    add_header Access-Control-Allow-Methods <span class="string">&#x27;GET, POST, OPTIONS&#x27;</span>;</span><br><span class="line">    add_header Access-Control-Allow-Headers <span class="string">&#x27;DNT,X-Mx-ReqToken,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Authorization&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ($request_method = <span class="string">&#x27;OPTIONS&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">204</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ES6-语法"><a href="#ES6-语法" class="headerlink" title="*ES6 语法"></a>*ES6 语法</h3><p>常用的：let const,箭头函数,解构,Promise，async await, class, es module,proxy</p><h3 id="箭头函数与普通函数区别？"><a href="#箭头函数与普通函数区别？" class="headerlink" title="箭头函数与普通函数区别？"></a>箭头函数与普通函数区别？</h3><p>1、没有<strong>自己的 this</strong>，arguments，super 或 new.target</p><p>2、.call()/.apply()/.bind()<strong>无法改变箭头函数中 this 的指向</strong></p><p>3、箭头函数表达式更适用于那些本来需要匿名函数的地方，并且它<strong>不能用作构造函数</strong></p><p>4、箭头函数<strong>没有 prototype</strong></p><p>5、箭头函数不能用作 Generator 函数，不能使用 yeild 关键字</p><p>箭头函数不会创建自己的<code>this,它只会从自己的作用域链的上一层继承this</code></p><h3 id="this-指向问题"><a href="#this-指向问题" class="headerlink" title="*this 指向问题"></a>*this 指向问题</h3><ol><li><p>fn</p><p>this -&gt; window/global</p></li><li><p>obj.fn()</p><p>this -&gt; obj</p></li><li><p>fn.call(xxx)/fn.apply(xxx)/fn.bind(xxx)</p><p>this -&gt; xx</p></li><li><p>new Fn()</p><p>this -&gt; 新的对象</p></li><li><p>fn = ()=&gt;{}</p><p>this -&gt; 外面的 this</p></li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">func(p1, p2) 等价于</span><br><span class="line">func.call(<span class="literal">undefined</span>, p1, p2)</span><br><span class="line"></span><br><span class="line">obj.child.method(p1, p2) 等价于</span><br><span class="line">obj.child.method.call(obj.child, p1, p2)</span><br></pre></td></tr></table></figure><blockquote><p>如果 call 中传的 context 是 null 或 undefined，那么 window 对象就是默认的 context（严格模式下默认 context 是 undefined）</p></blockquote><p><strong>[ ] 中的 this</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span> (<span class="params"></span>)</span>&#123; <span class="built_in">console</span>.log(<span class="built_in">this</span>) &#125;</span><br><span class="line"><span class="keyword">var</span> arr = [fn, fn2]</span><br><span class="line">arr[<span class="number">0</span>]() <span class="comment">// 这里面的 this 又是什么呢？</span></span><br><span class="line"></span><br><span class="line">        arr[<span class="number">0</span>]()</span><br><span class="line">假想为    arr<span class="number">.0</span>()</span><br><span class="line">然后转换为 arr<span class="number">.0</span>.call(arr)</span><br><span class="line">那么里面的 <span class="built_in">this</span> 就是 arr 了 :)</span><br></pre></td></tr></table></figure><p><strong>Event Handler 中的 this</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">btn.addEventListener(<span class="string">&quot;click&quot;</span>, <span class="function"><span class="keyword">function</span> <span class="title">handler</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">this</span>); <span class="comment">// 请问这里的 this 是什么</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//通常来说this的值是触发事件的元素的引用,当使用 addEventListener() 为一个元素注册事件的时候，句柄里的 this 值是该元素的引用。其与传递给句柄的 event 参数的 currentTarget 属性的值一样</span></span><br></pre></td></tr></table></figure><h3 id="什么是闭包-立即执行函数"><a href="#什么是闭包-立即执行函数" class="headerlink" title="什么是闭包/立即执行函数"></a>什么是闭包/立即执行函数</h3><blockquote><p>红宝书(p178)上对于闭包的定义：闭包是指有权访问另外一个函数作用域中的变量的函数</p></blockquote><blockquote><p>闭包允许函数访问函数外部的变量。只要变量或函数存在于声明函数时所在的作用域内</p></blockquote><p>闭包的作用：</p><ul><li>可以访问函数外部的变量</li><li>让这些变量始终保存在内存中,不会再函数调用结束后被垃圾回收机制回收</li><li>实现私有变量</li></ul><p><strong>闭包产生的原因？</strong></p><p>作用域链</p><p>当访问一个变量时，解释器会首先在当前作用域查找，如果没有找到，就去父作用域找，直到找到该变量。</p><p>每一个子函数都会拷贝上级的作用域，形成一个作用域的链条</p><p><strong>闭包的表现形式</strong></p><ol><li>函数内返回一个函数</li><li>函数作为参数传递（比如回调函数）</li></ol><h3 id="原型链"><a href="#原型链" class="headerlink" title="原型链"></a>原型链</h3><h3 id="介绍-Promise"><a href="#介绍-Promise" class="headerlink" title="介绍 Promise"></a>介绍 Promise</h3><p>Promise 是异步编程的一种解决方案,可以解决回调地狱问题。</p><p><strong><em>promise 的三种状态</em></strong></p><ul><li>pending 初始状态</li><li>fulfilled 操作完成完成</li><li>rejected 操作失败</li></ul><p><strong>API</strong></p><ul><li>Promise.resolve 返回一个给定值解析后的 Promise 对象 。<ul><li>如果这个值是 promise，那么返回这个 promise</li><li>如果是 thenable（带有 then 方法），返回的 promise 会“跟随”这个 thenable 的对象，采用它的最终状态</li><li>其他情况以该值为成功状态返回一个 Promise 对象。</li></ul></li><li>Promise.reject 类似</li><li>Promise.all 如果全部成功执行，则以数组的方式返回所有 Promise 任务的执行结果。 如果有一个 Promise 任务 rejected，则只返回 rejected 任务的结果。</li><li>Promise.race 多个 Promise 任务同时执行，返回最先执行结束的 Promise 任务的结果，不管这个 Promise 结果是成功还是失败。</li></ul><blockquote><p>怎么取消一个 Promise?</p></blockquote><p>Promise.race</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> p1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  resolve(<span class="string">&quot;ok1&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> p2 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    resolve(<span class="string">&quot;ok2&quot;</span>);</span><br><span class="line">  &#125;, <span class="number">10</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">Promise</span>.race([p2, p1])</span><br><span class="line">  .then(<span class="function">(<span class="params">result</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(result); <span class="comment">//ok1</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(error);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><p>返回“pending”状态的 Promise 对象</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Promise</span>.resolve()</span><br><span class="line">  .then(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;ok1&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">() =&gt;</span> &#123;&#125;); <span class="comment">// 返回“pending”状态的Promise对象</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 后续的函数不会被调用</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;ok2&quot;</span>);</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;err-&gt;&quot;</span>, err);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><h3 id="深拷贝"><a href="#深拷贝" class="headerlink" title="深拷贝"></a>深拷贝</h3><p>1、递归</p><p>2、判断类型，不同的类型要有不同的拷贝方法</p><p>3、<strong>检查循环引用</strong></p><p>使用一个<code>WeakMap</code>结构存储已经被拷贝的对象，每一次进行拷贝的时候就先向<code>WeakMap</code>查询该对象是否已经被拷贝，如果已经被拷贝则取出该对象并返回</p><p>4、不可能拷贝** proto**</p><h3 id="不用-class-如何实现继承？"><a href="#不用-class-如何实现继承？" class="headerlink" title="不用 class 如何实现继承？"></a>不用 class 如何实现继承？</h3><p>寄生组合继承</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Animal</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">  <span class="comment">//属性</span></span><br><span class="line">  <span class="built_in">this</span>.name = name;</span><br><span class="line">  <span class="comment">//实例方法</span></span><br><span class="line">  <span class="built_in">this</span>.sleep = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;正在睡觉&quot;</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//原型方法</span></span><br><span class="line">Animal.prototype.eat = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;正在吃东西&quot;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Cat</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">  Animal.apply(<span class="built_in">this</span>);</span><br><span class="line">  <span class="built_in">this</span>.name = name;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 原型的继承</span></span><br><span class="line"><span class="keyword">let</span> f = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line">f.prototype = Animal.prototype;</span><br><span class="line">Cat.prototype = <span class="keyword">new</span> f();</span><br><span class="line"></span><br><span class="line">Cat.prototype.constructor = Cat;</span><br></pre></td></tr></table></figure><p>用 class 实现的继承</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cat</span> <span class="keyword">extends</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="数组去重"><a href="#数组去重" class="headerlink" title="数组去重"></a>数组去重</h3><p>1、使用 hash</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">uniq</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> temp = &#123;&#125;,</span><br><span class="line">    res = [];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!temp[arr[i]]) &#123;</span><br><span class="line">      temp[arr[i]] = <span class="literal">true</span>;</span><br><span class="line">      res.push(arr[i]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2、Set</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [...new <span class="built_in">Set</span>(array)];</span><br></pre></td></tr></table></figure><p>3、Map</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">uniq</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line">  <span class="keyword">return</span> arr.filter(<span class="function">(<span class="params">a</span>) =&gt;</span> !res.has(a) &amp;&amp; res.set(a, <span class="number">1</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="数组扁平化"><a href="#数组扁平化" class="headerlink" title="数组扁平化"></a>数组扁平化</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">flatten</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> res = [];</span><br><span class="line">  arr.forEach(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">Array</span>.isArray(item)) &#123;</span><br><span class="line">      res = res.concat(flatten(item));</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      res.push(item);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">flatten</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">while</span> (arr.some(<span class="function">(<span class="params">item</span>) =&gt;</span> <span class="built_in">Array</span>.isArray(item))) &#123;</span><br><span class="line">    arr = [].concat(...arr);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="a-1-amp-amp-a-2-amp-amp-a-3"><a href="#a-1-amp-amp-a-2-amp-amp-a-3" class="headerlink" title="a==1&amp;&amp;a==2&amp;&amp;a==3"></a>a==1&amp;&amp;a==2&amp;&amp;a==3</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> a = &#123; <span class="attr">value</span>: <span class="number">0</span> &#125;;</span><br><span class="line">a.valueOf = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (<span class="built_in">this</span>.value += <span class="number">1</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><blockquote><p>(a === 1 &amp;&amp; a === 2 &amp;&amp; a ===3)的值也能是 true 吗？</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> value = <span class="number">0</span>; <span class="comment">//window.value</span></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(<span class="built_in">window</span>, <span class="string">&quot;a&quot;</span>, &#123;</span><br><span class="line">  get: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">this</span>.value += <span class="number">1</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="用正则实现-trim"><a href="#用正则实现-trim" class="headerlink" title="用正则实现 trim"></a>用正则实现 trim</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">trim</span>(<span class="params">string</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> string.replace(<span class="regexp">/^\s+|\s+$/g</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id=""><a href="#" class="headerlink" title=""></a></h3><h2 id="Webpack"><a href="#Webpack" class="headerlink" title="Webpack"></a>Webpack</h2><h3 id="有哪些常见的-loader-和-plugin"><a href="#有哪些常见的-loader-和-plugin" class="headerlink" title="有哪些常见的 loader 和 plugin"></a>有哪些常见的 loader 和 plugin</h3><p><strong>Loader</strong></p><ul><li><p>html</p><p>html-loader ,file-loader(对 html 动态取名),extract-loader(html 和 bundle.js 进行区分)</p></li><li><p>css</p><p>style-loader , css-loader,scss-loader,less-loader</p></li><li><p>js</p><p>babel-loader,eslint-loader</p></li><li><p>图片</p><p>image-loader（加载并且压缩图片文件）</p></li></ul><p><strong>Plugin</strong></p><p>html-webpack-plugin</p><p>uglifyjs-webpack-plugin：通过<code>UglifyES</code>压缩<code>ES6</code>代码</p><p>happypack(使用多线程)</p><p><strong>loader 和 plugin 的区别</strong></p><p>loader 直译为”加载器”。Loader 的作用是让 webpack 拥有了加载和解析<em>非 js 文件</em>的能力</p><p>plugin 直译为”插件”。是用于扩展 webpack 的功能的</p><p>Loader 在 module.rules 中配置</p><p>Plugin 在 plugin 中单独配置</p><h3 id="如何按需加载代码"><a href="#如何按需加载代码" class="headerlink" title="如何按需加载代码"></a>如何按需加载代码</h3><p>import(‘file’).then()</p><h3 id="如何提高构建速度"><a href="#如何提高构建速度" class="headerlink" title="如何提高构建速度"></a>如何提高构建速度</h3><p>happypack(使用多线程)</p><p>webpack-uglifyjs-parallel 来进行代码压缩，并开启多线程</p><p>DLL <strong>预编译资源模块</strong>，通过 DLLPlugin 来对那些我们引用但不会修改的 npm 包来进行预编译</p><h3 id="打包后文件过大怎么办"><a href="#打包后文件过大怎么办" class="headerlink" title="打包后文件过大怎么办"></a>打包后文件过大怎么办</h3><ul><li>压缩 js，css ，图片文件</li><li>使用 CommonsChunkPlugin 提取通用模块文件</li><li>使用 import（）按需加载</li><li>使用 CDN 加速。</li></ul><h2 id="Vue"><a href="#Vue" class="headerlink" title="Vue"></a>Vue</h2><h3 id="Watch-和-compute-的区别"><a href="#Watch-和-compute-的区别" class="headerlink" title="*Watch 和 compute 的区别"></a>*Watch 和 compute 的区别</h3><p>watch 是监听一个值的变化，compute 是计算属性。</p><p>compute 的值在执行后是会<strong>缓存</strong>的，只有在他依赖的值发生改变后才会重新求值。</p><p>watch 在每次监听值的变化是，都会执行回调函数。</p><h3 id="有哪些生命周期钩子函数？分别有什么用？"><a href="#有哪些生命周期钩子函数？分别有什么用？" class="headerlink" title="*有哪些生命周期钩子函数？分别有什么用？"></a>*有哪些生命周期钩子函数？分别有什么用？</h3><p>8 种</p><ul><li><p>beforeCreate 在<strong>实例初始化</strong>之后，数据观测 (data observer) 和 event/watcher 事件配置之前被调用</p></li><li><p>Created 在实<strong>例创建完成</strong>后被立即调用。实例已完成数据观测，watch/event 的回调，但是挂载还没开始，$el 上不可用</p></li><li><p>beforeMount 在<strong>挂载</strong>之前调用</p></li><li><p>Mounted 在挂载完成之后调用。注意：<strong>不会</strong>保证所有的子组件也都一起被挂载</p></li><li><p>beforeUpdated</p></li><li><p>Updated</p></li><li><p>beforeDestory 实例销毁前被调用。在这一步，实例仍然可用。</p></li><li><p>Destroyed 实例销毁后调用。该钩子被调用后，所以子实例也被销毁，事件监听被移除，指令被解绑。</p></li></ul><p>一般在 mounted 周期内进行数据请求，因为这个周期开始组件已经被挂载到真实的元素上。</p><h3 id="组件通信"><a href="#组件通信" class="headerlink" title="*组件通信"></a>*组件通信</h3><ol><li><p>父子组件:</p><ul><li>触发 $emit(‘event name’,data)</li><li>监听 $on(‘event name’,function(){})</li></ul></li><li><p>爷孙组件/兄弟组件</p><p>eventBus</p></li><li><p>Vuex</p></li></ol><h3 id="Vue-的数据响应式"><a href="#Vue-的数据响应式" class="headerlink" title="Vue 的数据响应式"></a>Vue 的数据响应式</h3><p>vue 的响应式主要通过数据劫持。vue 通过 Object.defineProperty 的 <strong>getter/setter</strong> 对目标进行监听,在属性被访问和修改时通知变化,进而更新视图数据</p><p>缺点：</p><ul><li>不能检测到对象属性的添加或删除</li><li>Vue 不能检测以下数组的变动：<ol><li>当你利用索引直接设置一个数组项时，例如：<code>vm.items[indexOfItem] = newValue</code></li><li>当你修改数组的长度时 ，例如：<code>vm.items.length = newLength</code></li></ol></li><li>不能检测到数据的新增（但是可以使用 Vue.set ）</li></ul><h3 id="Vue-router"><a href="#Vue-router" class="headerlink" title="Vue-router"></a>Vue-router</h3><p>vue-router 有哪几种守卫？</p><ul><li>全局前置 beforeEach</li><li>全局后置 afterEach</li><li>路由独享钩子 beforEnter</li></ul><p>守卫一般来做登录验证</p><p>vue-router 的两种模式</p><p>hash</p><ul><li>原理是 onhashchage 事件，可以在 window 对象上监听这个事件</li></ul><p>history</p><ul><li>利用了 HTML5 History Interface 中新增的 pushState()和 replaceState()方法。</li><li>需要后台配置支持。如果刷新时，服务器没有响应响应的资源，会刷出 404</li></ul><h3 id="Vuex"><a href="#Vuex" class="headerlink" title="Vuex"></a>Vuex</h3><p>Vuex 是一个 vue 的状态管理工具，它采用集中式存储管理应用的所有组件的状态。</p><p>有五个核心概念：state,getter,mutation,action,module</p><p><strong>什么时候用 vuex？</strong></p><p>当项目遇到以下两种场景时</p><ul><li>多个组件依赖于同一状态时。</li><li>来自不同组件的行为需要变更同一状态。</li></ul><h3 id="虚拟-dom"><a href="#虚拟-dom" class="headerlink" title="虚拟 dom"></a>虚拟 dom</h3><blockquote><p>虚拟 dom 是什么？</p></blockquote><p>虚拟 dom 是一个能代表 DOM 树的对象，通常包含标签名，属性，事件和子元素</p><blockquote><p>虚拟 dom 的优点</p></blockquote><p>能减少不必要的 dom 操作</p><p>能跨平台渲染（虚拟 dom 就是一个 js 对象，可以变成 dom 和可以变成小程序里的元素等）</p><blockquote><p>虚拟 dom 的缺点</p></blockquote><p>需要额外的创建函数，如 createElement 和 h</p><p>需要额外的构建过程，比如需要 jsx 需要 babel，vue 需要 vue-loader</p><p><strong>规模较小的时候，虚拟 dom 更快</strong></p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><h3 id="Ajax"><a href="#Ajax" class="headerlink" title="*Ajax"></a>*Ajax</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">xhr.open(<span class="string">&quot;get&quot;</span>, <span class="string">&quot;url&quot;</span>);</span><br><span class="line">xhr.onreadystatechange = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (xhr.readyState == <span class="number">4</span>) &#123;</span><br><span class="line">    <span class="comment">// HTTP 状态在 200-300 之间表示请求成功</span></span><br><span class="line">    <span class="comment">// HTTP 状态为 304 表示请求内容未发生改变，可直接从缓存中读取</span></span><br><span class="line">    <span class="keyword">if</span> ((xhr.status &gt;= <span class="number">200</span> &amp;&amp; xhr.status &lt; <span class="number">300</span>) || xhr.status == <span class="number">304</span>) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(xhr.responseText);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// xhr.readyStatus==0 尚未调用 open 方法</span></span><br><span class="line"><span class="comment">// xhr.readyStatus==1 已调用 open 但还未发送请求（未调用 send）</span></span><br><span class="line"><span class="comment">// xhr.readyStatus==2 已发送请求（已调用 send）</span></span><br><span class="line"><span class="comment">// xhr.readyStatus==3 已接收到请求返回的数据</span></span><br><span class="line"><span class="comment">// xhr.readyStatus==4 请求已完成</span></span><br><span class="line">xhr.send(<span class="literal">null</span>);</span><br></pre></td></tr></table></figure><h3 id="Promise"><a href="#Promise" class="headerlink" title="*Promise"></a>*Promise</h3><h3 id="Promise-all"><a href="#Promise-all" class="headerlink" title="*Promise.all"></a>*Promise.all</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">promiseAll</span>(<span class="params">list</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">Array</span>.isArray(list)) &#123;</span><br><span class="line">      reject(<span class="string">&quot;arguments must be array&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> count = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">let</span> res = [];</span><br><span class="line">    list.forEach(<span class="function">(<span class="params">p</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">Promise</span>.resolve(p)</span><br><span class="line">        .then(<span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</span><br><span class="line">          res.push(value);</span><br><span class="line">          count++;</span><br><span class="line">          <span class="keyword">if</span> (count === list.length) &#123;</span><br><span class="line">            resolve(res);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        .catch(<span class="function">(<span class="params">error</span>) =&gt;</span> reject(error));</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="instanceOf"><a href="#instanceOf" class="headerlink" title="instanceOf"></a>instanceOf</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myinstanceof</span>(<span class="params">left, right</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> prototype = right.prototype;</span><br><span class="line">  left = left.__proto__;</span><br><span class="line">  <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (left === <span class="literal">null</span> || left === <span class="literal">undefined</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (left === prototype) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    left = left.__proto__;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(myinstanceof([], <span class="built_in">Array</span>));</span><br></pre></td></tr></table></figure><h3 id="事件委托"><a href="#事件委托" class="headerlink" title="事件委托"></a>事件委托</h3><p>简易版本</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ul.addEventListener(<span class="string">&quot;click&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (e.target.tagName.toLowerCase() === <span class="string">&quot;li&quot;</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;点击了li&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>完整</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">ul.addEventListener(<span class="string">&quot;click&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> el = e.target;</span><br><span class="line">  <span class="keyword">while</span> (!el.matches(<span class="string">&quot;li&quot;</span>)) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="string">&quot;ul&quot;</span> === el) &#123;</span><br><span class="line">      el = <span class="literal">null</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    el = el.parentNode;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (el) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;点击了li&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//封装成函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">on</span>(<span class="params">element, eventType, selector, fn</span>) </span>&#123;</span><br><span class="line">  element.addEventListener(eventType, <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> el = e.target;</span><br><span class="line">    <span class="keyword">while</span> (!el.matches(selector)) &#123;</span><br><span class="line">      <span class="keyword">if</span> (element === el) &#123;</span><br><span class="line">        el = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      el = el.parentNode;</span><br><span class="line">    &#125;</span><br><span class="line">    el &amp;&amp; fn.call(el, e, el);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> element;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="拖拽-div"><a href="#拖拽-div" class="headerlink" title="拖拽 div"></a>拖拽 div</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> box = <span class="built_in">document</span>.querySelector(<span class="string">&quot;.drag-box&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> dragging = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">let</span> position = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">box.addEventListener(<span class="string">&quot;mousedown&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">  dragging = <span class="literal">true</span>;</span><br><span class="line">  position = [e.clientX, e.clientY];</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">document</span>.addEventListener(<span class="string">&quot;mousemove&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (dragging === <span class="literal">false</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> deltaX = e.clientX - position[<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">const</span> deltaY = e.clientY - position[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> left = <span class="built_in">parseInt</span>(box.style.left) || <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">const</span> top = <span class="built_in">parseInt</span>(box.style.top) || <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  box.style.left = left + deltaX + <span class="string">&quot;px&quot;</span>;</span><br><span class="line">  box.style.top = top + deltaY + <span class="string">&quot;px&quot;</span>;</span><br><span class="line">  position = [e.clientX, e.clientY];</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">document</span>.addEventListener(<span class="string">&quot;mouseup&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">  dragging = <span class="literal">false</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="compose-curry"><a href="#compose-curry" class="headerlink" title="compose,curry"></a>compose,curry</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">compose</span>(<span class="params">...funcs</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">x</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> funcs.reduce(<span class="function">(<span class="params">acc, fn</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> fn(acc);</span><br><span class="line">    &#125;, x);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// const compose = (...funcs) =&gt; (x) =&gt; funcs.reduce((acc, fn) =&gt; fn(acc), x);</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">upperCase</span>(<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> input &amp;&amp; <span class="keyword">typeof</span> input === <span class="string">&quot;string&quot;</span> ? input.toUpperCase() : input;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">trim</span>(<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">typeof</span> input === <span class="string">&quot;string&quot;</span> ? input.trim() : input;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> composedFunc = compose(trim, upperCase);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 当柯里化后的函数接收到足够的参数后，就会开始执行原函数。</span></span><br><span class="line"><span class="comment">//而如果接收到的参数不足的话，就会返回一个新的函数，用来接收余下的参数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">curry</span>(<span class="params">func</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">curried</span>(<span class="params">...args</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (args.length &gt;= func.length) &#123;</span><br><span class="line">      <span class="keyword">return</span> func.apply(<span class="built_in">this</span>, args);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">...args2</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> curried.apply(<span class="built_in">this</span>, args.concat(args2));</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> add = <span class="function">(<span class="params">a, b</span>) =&gt;</span> a + b;</span><br><span class="line"><span class="keyword">const</span> curriedAdd = curry(add);</span><br><span class="line"><span class="built_in">console</span>.log(curriedAdd(<span class="number">1</span>));</span><br><span class="line"><span class="built_in">console</span>.log(curriedAdd(<span class="number">1</span>)(<span class="number">2</span>));</span><br></pre></td></tr></table></figure><h3 id="apply-call"><a href="#apply-call" class="headerlink" title="apply,call"></a>apply,call</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Function</span>.prototype.myApply = <span class="function"><span class="keyword">function</span> (<span class="params">...args</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="built_in">this</span> !== <span class="string">&quot;function&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">&quot;Error&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> [context, params] = args;</span><br><span class="line">  context = context || <span class="built_in">window</span>;</span><br><span class="line">  context.fn = <span class="built_in">this</span>;</span><br><span class="line">  <span class="keyword">const</span> result = params ? context.fn(...params) : context.fn();</span><br><span class="line">  <span class="keyword">delete</span> context.fn;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">Function</span>.prototype.myCall = <span class="function"><span class="keyword">function</span> (<span class="params">...args</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="built_in">this</span> !== <span class="string">&quot;function&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">&quot;Error&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> [context, ...params] = args;</span><br><span class="line">  context = context || <span class="built_in">window</span>;</span><br><span class="line">  context.fn = <span class="built_in">this</span>;</span><br><span class="line">  <span class="keyword">const</span> result = context.fn(...params);</span><br><span class="line">  <span class="keyword">delete</span> context.fn;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="深拷贝-1"><a href="#深拷贝-1" class="headerlink" title="深拷贝"></a>深拷贝</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">deepClone</span>(<span class="params">target, cache = <span class="keyword">new</span> <span class="built_in">Map</span>()</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!(target <span class="keyword">instanceof</span> <span class="built_in">Object</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> target;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (cache.has(target)) &#123;</span><br><span class="line">    <span class="keyword">return</span> target;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 判断四种特殊情况</span></span><br><span class="line">  <span class="keyword">const</span> l = <span class="function">() =&gt;</span> &#123;&#125;;</span><br><span class="line">  <span class="keyword">let</span> dist;</span><br><span class="line">  <span class="keyword">if</span> (target <span class="keyword">instanceof</span> <span class="built_in">Array</span>) &#123;</span><br><span class="line">    dist = [];</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (target <span class="keyword">instanceof</span> <span class="built_in">Function</span>) &#123;</span><br><span class="line">    dist = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> target.call(<span class="built_in">this</span>, ...arguments);</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (target <span class="keyword">instanceof</span> <span class="built_in">Date</span>) &#123;</span><br><span class="line">    dist = <span class="keyword">new</span> <span class="built_in">Date</span>(target);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (target <span class="keyword">instanceof</span> <span class="built_in">RegExp</span>) &#123;</span><br><span class="line">    dist = <span class="keyword">new</span> <span class="built_in">RegExp</span>(target.source, target.flags);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    dist = &#123;&#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  cache.set(dist, target);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> target) &#123;</span><br><span class="line">    <span class="keyword">if</span> (target.hasOwnProperty(key)) &#123;</span><br><span class="line">      dist[key] = deepClone(target[key], cache);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> dist;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="防抖节流"><a href="#防抖节流" class="headerlink" title="防抖节流"></a>防抖节流</h3><p><strong>函数防抖：</strong>将几次操作合并为一此操作进行</p><p>应用：联想输入框</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">debounce</span>(<span class="params">fn, delay</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> timeout = <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">clearTimeout</span>(timeout);</span><br><span class="line">    timeout = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      fn.call(<span class="built_in">this</span>);</span><br><span class="line">    &#125;, delay);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>函数节流：</strong>使得一定时间内只触发一次函数</p><p>应用：</p><ul><li><p>懒加载要监听计算滚动条的位置，使用节流按一定时间的频率获取。</p></li><li><p>用户点击提交按钮，假设我们知道接口大致的返回时间的情况下，我们使用节流，只允许一定时间内点击一次。</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">function <span class="title">throttle</span><span class="params">(fn, delay)</span> </span>&#123;</span><br><span class="line">        let timeout = <span class="keyword">null</span></span><br><span class="line">        <span class="keyword">return</span> function () &#123;</span><br><span class="line">            <span class="keyword">if</span> (!timeout) &#123;</span><br><span class="line">                timeout = setTimeout(() =&gt; &#123;</span><br><span class="line">                    fn.call(<span class="keyword">this</span>);</span><br><span class="line">                    timeout = <span class="keyword">null</span>;</span><br><span class="line">                &#125;, delay);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>js 和 css 动画区别</p><p>chrome tab 进程</p><p>chrome 相同域名 一般公用一个进程</p><p>tree shaking 原理</p><p>代码分割 code split</p><h2 id="权限控制"><a href="#权限控制" class="headerlink" title="权限控制"></a>权限控制</h2><p>从 大中小 三个方面来看</p><p>页面级别</p><p>菜单级别</p><p>按钮级别</p>]]></content>
      
      
      
        <tags>
            
            <tag> 笔记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【踩坑总结】Electron中开发子进程时遇到的问题</title>
      <link href="/2020/05/07/electron-problem/"/>
      <url>/2020/05/07/electron-problem/</url>
      
        <content type="html"><![CDATA[<blockquote><p>问题：在开发过程中，创建了一个子进来程执行 cmd 的命令。在开发环境中没有任何问题，但是在打包后发现子进程并没有执行。</p></blockquote><span id="more"></span><blockquote><p>参考资料: <a href="https://segmentfault.com/a/1190000019981621?utm_source=tag-newest">https://segmentfault.com/a/1190000019981621?utm_source=tag-newest</a></p></blockquote><p>1.子进程中用到的引用的外部资源需要在 pacage.json 中配置，比如我将一个 jar 文件放在了 api 文件夹中。</p><p>首先需要在 asarUnpack 中配置子进程中用到的第三方包</p><p>extraResources 用来配置资源文件的映射。匹配的路径会直接映射到对应的资源的路径（<code>Contents/Resources</code> for MacOS, <code>resources</code> for Linux and Windows）</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;build&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;asarUnpack&quot;</span>: [</span><br><span class="line">      <span class="string">&quot;**/api/**/*&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="string">&quot;extraResources&quot;</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="string">&quot;from&quot;</span>: <span class="string">&quot;api&quot;</span>,</span><br><span class="line">        <span class="string">&quot;to&quot;</span>: <span class="string">&quot;app.asar.unpacked/api&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line"></span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure><ol start="2"><li><p>子进程中的路径问题</p><p> electron 中开发和打包后子进程的 fork 路径并不相同。在开发环境中可以使用相对路径，但是打包后不行。</p><p> 路径需要做如下配置。</p><blockquote><p><code>process.resoucesPath</code>: electron 中定义的资源目录的路径，在打包后子进程 js 所在的路径</p></blockquote> <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = isDev ? path.join(__dirname, <span class="string">&#x27;api&#x27;</span>) : path.join(process.resourcesPath, <span class="string">&#x27;app.asar.unpacked/api&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> exec = <span class="built_in">require</span>(<span class="string">&#x27;child_process&#x27;</span>).exec;</span><br><span class="line"><span class="keyword">let</span> cmdStr = <span class="string">&#x27;java -jar deliveryroute.jar&#x27;</span>;</span><br><span class="line"><span class="keyword">let</span> workerProcess = exec(cmdStr, &#123; <span class="attr">cwd</span>: path &#125;);</span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> electron </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>centos7下各种环境的安装</title>
      <link href="/2019/12/21/centos7-develop-config/"/>
      <url>/2019/12/21/centos7-develop-config/</url>
      
        <content type="html"><![CDATA[<p>最近我的云服务器又又又崩了，又得重新整一遍😭</p><p>记录一下常用工具的配置吧</p><span id="more"></span><h2 id="第一步，换源"><a href="#第一步，换源" class="headerlink" title="第一步，换源"></a>第一步，换源</h2><p>最好先换源，因为官方源在国外，会很慢。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">进入yum源配置文件所在的文件夹</span><br><span class="line">cd &#x2F;etc&#x2F;yum.repos.d&#x2F;</span><br><span class="line"></span><br><span class="line">备份本地yum源</span><br><span class="line">mv CentOS-Base.repo CentOS-Base.repo_bak</span><br><span class="line"></span><br><span class="line">获取国内yum源（阿里、163二选一）</span><br><span class="line"></span><br><span class="line">wget -O CentOS-Base.repo http:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;repo&#x2F;Centos-7.repo</span><br><span class="line"></span><br><span class="line">wget -O CentOS-Base.repo http:&#x2F;&#x2F;mirrors.163.com&#x2F;.help&#x2F;CentOS7-Base-163.repo</span><br><span class="line"></span><br><span class="line">清理yum缓存 </span><br><span class="line">yum clean all</span><br><span class="line"></span><br><span class="line">重建缓存 </span><br><span class="line">yum makecache </span><br><span class="line"></span><br><span class="line">更新</span><br><span class="line">yum -y update </span><br></pre></td></tr></table></figure><p>然后就可以快乐的搭建环境了</p><h2 id="JAVA"><a href="#JAVA" class="headerlink" title="JAVA"></a>JAVA</h2><p>首先查询是否安装了JDK</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#直接运行java命令，会提示命令未找到，则是没有安装过java环境</span></span><br><span class="line">java</span><br><span class="line">-bash: java: <span class="built_in">command</span> not found</span><br><span class="line"></span><br><span class="line">或者</span><br><span class="line">yum list installed |grep java</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#卸载安装的 jdk</span></span><br><span class="line">yum -y remove java*</span><br></pre></td></tr></table></figure><p>查看yum库中的Java安装包</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum list java*</span><br></pre></td></tr></table></figure><p>以yum库中java-1.8.0为例, “*”表示将java-1.8.0的所有相关Java程序都安装上</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install java-1.8.0-openjdk*</span><br></pre></td></tr></table></figure><p>查看版本，检测是否安装成功</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -version</span><br></pre></td></tr></table></figure><h2 id="nodejs"><a href="#nodejs" class="headerlink" title="nodejs"></a>nodejs</h2><p>更新node.js各版本yum源</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Node.js v8.x</span></span><br><span class="line"></span><br><span class="line">curl --silent --location https://rpm.nodesource.com/setup_8.x | bash -</span><br><span class="line"></span><br><span class="line"><span class="comment">#Node.js v7.x</span></span><br><span class="line"></span><br><span class="line">curl --silent --location https://rpm.nodesource.com/setup_7.x | bash -</span><br><span class="line"></span><br><span class="line"><span class="comment">#Node.js v6.x</span></span><br><span class="line"></span><br><span class="line">curl --silent --location https://rpm.nodesource.com/setup_6.x | bash -</span><br></pre></td></tr></table></figure><p>使用yum安装nodejs</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y nodejs</span><br></pre></td></tr></table></figure><p>查看nodejs和npm版本</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">node -v </span><br><span class="line"></span><br><span class="line">npm -v</span><br></pre></td></tr></table></figure><p>使用npm安装node版本管理器 ‘ n ‘</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g n</span><br></pre></td></tr></table></figure><p>版本管理</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#查看所有版本</span></span><br><span class="line">n list</span><br><span class="line"></span><br><span class="line"><span class="comment">#安装指定版本</span></span><br><span class="line">n &lt;version&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">#安装最新版本</span></span><br><span class="line">n latest</span><br><span class="line"></span><br><span class="line"><span class="comment">#安装稳定版本</span></span><br><span class="line">n stable </span><br><span class="line"></span><br><span class="line"><span class="comment">#删除某个版本</span></span><br><span class="line">n rm &lt;version&gt;</span><br></pre></td></tr></table></figure><h3 id="服务器管理模块forever"><a href="#服务器管理模块forever" class="headerlink" title="服务器管理模块forever"></a>服务器管理模块forever</h3><p>安装forever</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo npm install forever -g</span><br></pre></td></tr></table></figure><p>启动进程</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">forever start app.js</span><br></pre></td></tr></table></figure><p>关闭进程</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">forever stop app.js</span><br><span class="line"></span><br><span class="line">forever stopall</span><br><span class="line"></span><br><span class="line"><span class="comment">#forever list 找到对应的id，然后：</span></span><br><span class="line"></span><br><span class="line">forever stop [id]</span><br></pre></td></tr></table></figure><p>输出日至</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">forever start -l forever.log -o out.log -e err.log .&#x2F;var&#x2F;www</span><br></pre></td></tr></table></figure><p>显示所有运行的服务</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">forever list</span><br></pre></td></tr></table></figure><p>具体命令参数可以通过 forever –help 查看。  </p><p>或者 <a href="http://blog.fens.me/nodejs-server-forever/">服务器管理模块forever</a></p><h2 id="MYSQL5-7"><a href="#MYSQL5-7" class="headerlink" title="MYSQL5.7"></a>MYSQL5.7</h2><p>检查系统中是否已安装 MySQL</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -qa | grep mysql</span><br></pre></td></tr></table></figure><p>没反应的话就说明没有安装。  </p><p>注意：在新版本的CentOS7中，默认的数据库已更新为了Mariadb，而非 MySQL，所以执行 yum install mysql 命令只是更新Mariadb数据库，并不会安装 MySQL 。</p><p>查看已安装的 Mariadb 数据库版本</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -qa|grep -i mariadb</span><br></pre></td></tr></table></figure><p>卸载已安装的Mariabd</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -qa|grep mariadb|xargs rpm -e --nodeps</span><br></pre></td></tr></table></figure><p>确认是否卸载完成</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -qa|grep -i mariadb</span><br></pre></td></tr></table></figure><p>在MySQL官网中下载YUM源rpm安装包</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http:&#x2F;&#x2F;dev.mysql.com&#x2F;get&#x2F;mysql57-community-release-el7-8.noarch.rpm</span><br></pre></td></tr></table></figure><p>安装mysql源</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum localinstall mysql57-community-release-el7-8.noarch.rpm</span><br></pre></td></tr></table></figure><p>检查mysql源是否安装成功</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum repolist enabled | grep &quot;mysql.*-community.*&quot;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/zhouhuan327/assets/markdown/centos_img.jpg" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/zhouhuan327/assets/markdown/centos_img.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p>安装MySQL</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install mysql-community-server</span><br></pre></td></tr></table></figure><p>检查mysql是否安装成功</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -qa | grep mysql</span><br></pre></td></tr></table></figure><p>启动 mysql 服务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">systemctl start mysqld.service <span class="comment">#启动 mysql</span></span><br><span class="line">systemctl restart mysqld.service <span class="comment">#重启 mysql</span></span><br><span class="line">systemctl stop mysqld.service <span class="comment">#停止 mysql</span></span><br><span class="line">systemctl <span class="built_in">enable</span> mysqld.service <span class="comment">#设置 mysql 开机启动</span></span><br></pre></td></tr></table></figure><h3 id="设置密码"><a href="#设置密码" class="headerlink" title="设置密码"></a>设置密码</h3><blockquote><p>为了加强安全性，MySQL5.7为root用户随机生成了一个密码，如果安装的是RPM包，则默认是在/var/log/mysqld.log中</p></blockquote><p>获取随机生成的密码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep &quot;password&quot; &#x2F;var&#x2F;log&#x2F;mysqld.log</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p</span><br><span class="line"></span><br><span class="line">接着输入密码</span><br></pre></td></tr></table></figure><p>用该密码登录到服务端后，必须马上修改密码，不然会报如下错误</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select user();</span><br><span class="line"></span><br><span class="line">ERROR 1820 (HY000): You must reset your password using ALTER USER statement before executing this statement.</span><br></pre></td></tr></table></figure><p>如果只是修改为一个简单的密码，会报以下错误</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; ALTER USER USER() IDENTIFIED BY &#39;12345678&#39;;</span><br><span class="line"></span><br><span class="line">ERROR 1819 (HY000): Your password does not satisfy the current policy requirements</span><br></pre></td></tr></table></figure><p>这个其实与validate_password_policy的值有关。</p><p>validate_password_policy有以下取值：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">0 or LOWLength</span><br><span class="line"></span><br><span class="line">1 or MEDIUMLength; numeric, lowercase&#x2F;uppercase, and special characters</span><br><span class="line"></span><br><span class="line">2 or STRONGLength; numeric, lowercase&#x2F;uppercase, and special characters; dictionary file</span><br></pre></td></tr></table></figure><p>默认是1，即MEDIUM，所以刚开始设置的密码必须符合长度，且必须含有数字，小写或大写字母，特殊字符。</p><p>修改validate_password_policy参数的值</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; set global validate_password_policy&#x3D;0;</span><br><span class="line"></span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br></pre></td></tr></table></figure><p>这样，判断密码的标准就基于密码的长度了,最小为8</p><p>设置远程主机登录</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; GRANT ALL PRIVILEGES ON *.* TO &#39;your username&#39;@&#39;%&#39; IDENTIFIED BY &#39;your password&#39;;</span><br></pre></td></tr></table></figure><p>为root 用户添加远程登录的能力</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; GRANT ALL PRIVILEGES ON *.* TO root@&quot;%&quot; IDENTIFIED BY &quot;your password&quot;;</span><br></pre></td></tr></table></figure><p>这样就可以用navicate远程连接到数据库了<br><img src="https://cdn.jsdelivr.net/gh/zhouhuan327/assets/markdown/centos_img2.png" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/zhouhuan327/assets/markdown/centos_img2.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h2 id="mongodb"><a href="#mongodb" class="headerlink" title="mongodb"></a>mongodb</h2><p>找一个文件夹存放安装包，我这里使用的是 /usr</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd &#x2F;usr</span><br><span class="line"></span><br><span class="line">wget https:&#x2F;&#x2F;fastdl.mongodb.org&#x2F;linux&#x2F;mongodb-linux-x86_64-4.0.0.tgz</span><br></pre></td></tr></table></figure><p>解压缩安装包，并重命名文件夹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tar zxvf mongodb-linux-x86_64-4.0.0.tgz</span><br><span class="line"></span><br><span class="line">mv mongodb-linux-x86_64-4.0.0 mongodb</span><br></pre></td></tr></table></figure><p>配置环境变量</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim &#x2F;etc&#x2F;profile</span><br></pre></td></tr></table></figure><p>在 export PATH USER LOGNAME MAIL HOSTNAME HISTSIZE HISTCONTROL 一行的上面添加如下内容:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#Set Mongodb</span><br><span class="line">export PATH&#x3D;&#x2F;usr&#x2F;mongodb&#x2F;bin:$PATH</span><br></pre></td></tr></table></figure><p>保存后通过下面的命令使环境变量生效：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd ~</span><br><span class="line"></span><br><span class="line">source &#x2F;etc&#x2F;profile</span><br></pre></td></tr></table></figure><p>创建数据库目录</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cd &#x2F;usr&#x2F;mongodb</span><br><span class="line">touch mongodb.conf</span><br><span class="line">mkdir db</span><br><span class="line">mkdir log</span><br><span class="line">cd log</span><br><span class="line">touch mongodb.log</span><br></pre></td></tr></table></figure><p>修改mongodb配置文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim &#x2F;usr&#x2F;mongodb&#x2F;mongodb.conf</span><br></pre></td></tr></table></figure><p>添加以下内容</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">port=27017 <span class="comment">#端口</span></span><br><span class="line">dbpath= /usr/mongodb/db <span class="comment">#数据库存文件存放目录</span></span><br><span class="line">logpath= /usr/mongodb/<span class="built_in">log</span>/mongodb.log <span class="comment">#日志文件存放路径</span></span><br><span class="line">logappend=<span class="literal">true</span> <span class="comment">#使用追加的方式写日志</span></span><br><span class="line">fork=<span class="literal">true</span> <span class="comment">#以守护进程的方式运行，创建服务器进程</span></span><br><span class="line">maxConns=100 <span class="comment">#最大同时连接数</span></span><br><span class="line">noauth=<span class="literal">true</span> <span class="comment">#不启用验证</span></span><br><span class="line">journal=<span class="literal">true</span> <span class="comment">#每次写入会记录一条操作日志（通过journal可以重新构造出写入的数据）。</span></span><br><span class="line"><span class="comment">#即使宕机，启动时wiredtiger会先将数据恢复到最近一次的checkpoint点，然后重放后续的journal日志来恢复。</span></span><br><span class="line">storageEngine=wiredTiger  <span class="comment">#存储引擎有mmapv1、wiretiger、mongorocks</span></span><br><span class="line">bind_ip = 0.0.0.0  <span class="comment">#这样就可外部访问了，例如从win10中去连虚拟机中的MongoDB</span></span><br></pre></td></tr></table></figure><p>设置文件夹权限</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd &#x2F;usr&#x2F;mongodb</span><br><span class="line"></span><br><span class="line">chmod 777 db</span><br><span class="line"></span><br><span class="line">chmod 777 log</span><br></pre></td></tr></table></figure><p>启动mongodb</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd ~</span><br><span class="line"></span><br><span class="line">mongod --config &#x2F;usr&#x2F;mongodb&#x2F;mongodb.conf</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> 部署 </tag>
            
            <tag> 运维 </tag>
            
            <tag> centos </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Markdown常用语法</title>
      <link href="/2019/12/19/lean-markdown/"/>
      <url>/2019/12/19/lean-markdown/</url>
      
        <content type="html"><![CDATA[<p>记录一些常用的markdown语法格式</p><h2 id="1、标题"><a href="#1、标题" class="headerlink" title="1、标题"></a>1、标题</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># 标题一级</span><br><span class="line">## 标题二级</span><br><span class="line">### 标题三级</span><br><span class="line">#### 标题四级</span><br><span class="line"></span><br><span class="line">或者</span><br><span class="line"></span><br><span class="line">我展示的是一级标题</span><br><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line"></span><br><span class="line">我展示的是二级标题</span><br><span class="line">-----------------</span><br></pre></td></tr></table></figure><span id="more"></span><h2 id="2、字体"><a href="#2、字体" class="headerlink" title="2、字体"></a>2、字体</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">粗体：</span><br><span class="line">***加粗的字体***</span><br><span class="line"></span><br><span class="line">斜体：</span><br><span class="line"></span><br><span class="line">*倾斜的字体*</span><br><span class="line">或</span><br><span class="line">_倾斜的字体_</span><br></pre></td></tr></table></figure><p><strong><em>被加粗的字体</em></strong></p><p><em>倾斜的字体</em></p><h2 id="3、分隔线"><a href="#3、分隔线" class="headerlink" title="3、分隔线"></a>3、分隔线</h2><p>下面每种写法都可以建立分隔线</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">***</span><br><span class="line">* * *</span><br><span class="line">- - -</span><br></pre></td></tr></table></figure><h2 id="4、删除线、下划线"><a href="#4、删除线、下划线" class="headerlink" title="4、删除线、下划线"></a>4、删除线、下划线</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">~~带删除线文本~~</span><br><span class="line"></span><br><span class="line">&lt;u&gt;带下划线文本&lt;&#x2F;u&gt;</span><br></pre></td></tr></table></figure><p><del>带删除线文本</del></p><p><u>带下划线文本</u></p><h2 id="5、脚注"><a href="#5、脚注" class="headerlink" title="5、脚注"></a>5、脚注</h2><p>鼠标经过后显示脚注文本，类似于title</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">创建脚注格式类似这样 [^footnote]。</span><br><span class="line"></span><br><span class="line">[^footnote]: footnote-content</span><br></pre></td></tr></table></figure><p>生成一个脚注1<a href="footnote-content">^footnote</a>.  </p><h2 id="6、区块引用"><a href="#6、区块引用" class="headerlink" title="6、区块引用"></a>6、区块引用</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&gt;引用单行文字</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&gt; 带有多个段落的块引用</span><br><span class="line">&gt;</span><br><span class="line">&gt; 带有多个段落的块引用</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&gt; 嵌套引用1.</span><br><span class="line">&gt;</span><br><span class="line">&gt;&gt;  嵌套引用2.</span><br></pre></td></tr></table></figure><blockquote><p>引用文字的效果</p></blockquote><hr><blockquote><p>引用多行文字1</p><p>引用多行文字2</p></blockquote><hr><blockquote><p>嵌套引用1.</p><blockquote><p> 嵌套引用2.</p></blockquote></blockquote><h2 id="7、段落"><a href="#7、段落" class="headerlink" title="7、段落"></a>7、段落</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;-段落1</span><br><span class="line">&gt;-段落2</span><br><span class="line">&gt;-段落3</span><br></pre></td></tr></table></figure><blockquote><ul><li>段落1</li><li>段落2</li><li>段落3</li></ul></blockquote><h2 id="8、列表"><a href="#8、列表" class="headerlink" title="8、列表"></a>8、列表</h2><p>Markdown 支持有序列表和无序列表。</p><p>无序列表使用星号(*)、加号(+)或是减号(-)作为列表标记</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* 第一项</span><br><span class="line"></span><br><span class="line">+ 第三项</span><br><span class="line"></span><br><span class="line">- 第三项</span><br></pre></td></tr></table></figure><ul><li>第一项</li></ul><ul><li>第三项</li></ul><ul><li>第三项</li></ul><p>有序列表</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. 第一项</span><br><span class="line">2. 第二项</span><br><span class="line">3. 第三项</span><br></pre></td></tr></table></figure><ol><li>第一项</li><li>第二项</li><li>第三项</li></ol><h2 id="9、列表嵌套"><a href="#9、列表嵌套" class="headerlink" title="9、列表嵌套"></a>9、列表嵌套</h2><p>列表嵌套只需在子列表中的选项添加四个空格即可</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1. 第一项 :  </span><br><span class="line">    - 第一项嵌套的的第一个</span><br><span class="line">    - 第一项嵌套的的第一个</span><br><span class="line">2. 第二项</span><br><span class="line">    - 第二项嵌套的第一个</span><br><span class="line">        - 第二项嵌套的第二个</span><br></pre></td></tr></table></figure><ol><li>第一项 :  <ul><li>第一项嵌套的的第一个</li><li>第一项嵌套的的第一个</li></ul></li><li>第二项<ul><li>第二项嵌套的第一个<ul><li>第二项嵌套的第二个</li></ul></li></ul></li></ol><h2 id="10、列表中使用区块"><a href="#10、列表中使用区块" class="headerlink" title="10、列表中使用区块"></a>10、列表中使用区块</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">* 第一项</span><br><span class="line">    &gt; 区块内容1</span><br><span class="line">    &gt; 区块内容2</span><br><span class="line">* 第二项</span><br></pre></td></tr></table></figure><ul><li><p>第一项</p><blockquote><p>区块内容1<br>区块内容2<br>区块内容2  </p></blockquote></li><li><p>第二项</p></li></ul><h2 id="11、代码区块"><a href="#11、代码区块" class="headerlink" title="11、代码区块"></a>11、代码区块</h2><p>片段代码可以用反引号 ` 包裹  </p><p><code>printf()</code> 函数</p><p>用 ``` 包裹一段代码，并指定一种语言（也可以不指定）</p><p>javascript  </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">scrolltoElement</span>(<span class="params">elem, correction</span>) </span>&#123;</span><br><span class="line">correction = correction || scrollCorrection;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>css</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">display</span>:flex;</span><br></pre></td></tr></table></figure><h2 id="12、超链接"><a href="#12、超链接" class="headerlink" title="12、超链接"></a>12、超链接</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[链接名称](链接地址)</span><br><span class="line">或者</span><br><span class="line">&lt;链接地址&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[我的博客](http:&#x2F;&#x2F;www.zhsblog.top)</span><br><span class="line">&lt;http:&#x2F;&#x2F;www.zhsblog.top&gt;</span><br></pre></td></tr></table></figure><p><a href="http://www.zhsblog.top/">我的博客</a></p><h2 id="13、-图片"><a href="#13、-图片" class="headerlink" title="13、 图片"></a>13、 图片</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">![alt 属性文本](图片地址)</span><br><span class="line"></span><br><span class="line">![alt 属性文本](图片地址 &quot;可选标题&quot;)</span><br><span class="line"></span><br><span class="line">![一张头像图](https:&#x2F;&#x2F;cdn.jsdelivr.net&#x2F;gh&#x2F;zhouhuan327&#x2F;assets@1.2&#x2F;avatar&#x2F;cat.jpeg)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/zhouhuan327/assets@1.2/avatar/cat.jpeg" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/zhouhuan327/assets@1.2/avatar/cat.jpeg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="一张头像图"></p><p>使用img标签引入的图片可以控制宽高<br><code>&lt;img src=&quot;url&quot; width=&quot;50%&quot;&gt;</code>  </p><img src="https://cdn.jsdelivr.net/gh/zhouhuan327/assets@1.2/avatar/cat.jpeg" class="lazyload" data-srcset="https://cdn.jsdelivr.net/gh/zhouhuan327/assets@1.2/avatar/cat.jpeg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" width="30%"><h2 id="14、任务列表"><a href="#14、任务列表" class="headerlink" title="14、任务列表"></a>14、任务列表</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- [ ] 一次性水杯</span><br><span class="line">- [x] 西瓜</span><br><span class="line">- [ ] 豆浆</span><br><span class="line">- [x] 可口可乐</span><br><span class="line">- [ ] 小茗同学</span><br></pre></td></tr></table></figure><ul><li><input disabled="" type="checkbox"> 一次性水杯</li><li><input checked="" disabled="" type="checkbox"> 西瓜</li><li><input disabled="" type="checkbox"> 豆浆</li><li><input checked="" disabled="" type="checkbox"> 可口可乐</li><li><input disabled="" type="checkbox"> 小茗同学</li></ul><h2 id="16、折叠面板"><a href="#16、折叠面板" class="headerlink" title="16、折叠面板"></a>16、折叠面板</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;details&gt;</span><br><span class="line">&lt;summary&gt;点击展开&lt;&#x2F;summary&gt;</span><br><span class="line"></span><br><span class="line">content!!!</span><br><span class="line">&lt;&#x2F;details&gt;</span><br></pre></td></tr></table></figure><details><summary>点击展开</summary><p>content!!!</p></details>]]></content>
      
      
      <categories>
          
          <category> Markdown </category>
          
      </categories>
      
      
        <tags>
            
            <tag> markdown </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
